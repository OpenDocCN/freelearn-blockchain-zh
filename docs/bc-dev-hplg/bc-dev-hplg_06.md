# 第六章：商业网络

本章介绍并探讨了一个新概念——**商业网络**。通过理解什么是商业网络以及它们如何运作，您将能够理解区块链技术如何彻底改善它们。特别是，区块链，尤其是超级账本 Fabric 区块链，对商业网络提供了重大好处，因为它彻底简化了将企业联系在一起的信息和流程，既降低了成本，又为网络内的企业创造了新机遇。

我们将看到商业网络的概念允许您通过查看其与之交互的交易对手来分析企业。虽然商业网络是特定于行业的，但单个网络可以用于支持多个用例，并链接到其他商业网络以形成网络之间的网络。

我们将花一些时间介绍商业网络的词汇，介绍关键术语如**参与者**、**资产**、**交易**和**事件**。然后将这些元素组合起来来定义正在分析的商业问题的行为。我们能够使用业务需求来创建一个技术蓝图，该蓝图可用于实施解决方案。通过本章的学习，您将准备好使用超级账本 Fabric 和 Hyperledger Composer 来实施这些想法，而您将在接下来的章节中做到这一点。

尽管在实施区块链网络之前理解商业网络的概念是必要的，但您会发现它对更广泛的问题很有帮助，例如执行区块链分析、与现有系统集成以及如何构建应用程序和企业架构。从这个意义上说，本章可以单独阅读，而不必在之后实施网络。

在本章中，我们将涵盖以下主题：

+   商业网络的语言

+   商业网络的概念

+   定义商业网络

+   介绍参与者

+   介绍资产

+   介绍交易

+   介绍事件

+   实施商业网络

# 一个充满有意义的活动的繁忙世界

想象一下我们正在一架飞机上飞越一个大城市。我们可以看到工厂、银行、学校、医院、零售店、汽车展厅、港口的船只等等。这些是定义城市的结构。

如果我们仔细观察，就会看到在这些结构内部和之间发生的事情。卡车可能正在向工厂运送铁矿石，客户可能正在从银行提取资金，学生可能正在参加考试——这是一个繁忙的世界！

而且，如果我们能再仔细一点看，我们会看到所有这些人和组织都在与彼此进行有意义的活动。学生从老师那里接受评估，随后这将帮助他们进入大学。银行向可以搬家的客户提供贷款。工厂从原材料中制造组件，然后客户将其组装成复杂的物体。人们从经销商那里购买二手车，他们用来每天上班或度假！

我们可能会对所有这些结构和它们之间的过程的多样性感到惊叹。我们甚至可能会想知道它是如何如此轻松地共同运作的！

然后我们可能会反思所有这些多样化的活动，并想知道它们是否都有共同之处？是否有可重复的模式可以让我们理解所有这些复杂性？是否有一种分辨率，在这种活动看起来都一样？所有这些人和组织，在某种意义上，是在做同样的事情吗？

答案当然是肯定的！接下来的一节将会给我们一个更好的解释。

# 为什么要有一种用于商业网络的语言？

商业网络是一种思维方式，它允许我们审视所有这些活动，并用非常简单的语言描述它。而且，由于我们试图用一种对区块链有意义的语言来描述世界，而区块链是一种简单的技术，我们期望那种语言的词汇是简单的。在下一节中，你将会看到它就是这样！

但在我们深入探讨之前，让我们问一下*为什么*我们想要创造一种区块链能够理解的语言？嗯，如果我们可以的话，我们就可以将区块链的所有好处带到用那种语言描述的世界。而且，我们可以简洁地总结这些好处——增加的信任。

增加的信任意味着学生可以向他们的大学展示他们的高中证书，大学可以对资格的真实性感到放心。它意味着银行可以以最低的利率向客户提供贷款，因为它可以对客户的财务状况感到放心。它意味着组件制造商可以为他们的产品收取更高的价格，因为他们的客户可以确信原材料的质量，知道它们的来源。最后，购买二手车的买家可以对他们的购买感到放心，因为他们可以证明它以前只有一个细心的车主！

# 定义商业网络

我们可以用商业网络的概念总结所有这些想法：

商业网络是一组参与者和资产，经历由交易描述的生命周期。当交易完成时，事件发生。

你可能会想知道这意味着什么。经过所有这些铺垫之后，我们告诉你几个看似简单的句子描述了所有这些复杂性？

简单的答案是肯定的——我们很快会通过更详细地描述**参与者**、**资产**、**交易**和**事件**来解释。然后，你会发现所有这些丰富的行为都可以用相对简单的语言词汇来描述。

# 更深层次的想法

实际上，在业务网络背后有一个更深层次的想法——即技术的语言和词汇应与业务领域的语言和词汇紧密匹配，消除业务概念和技术概念之间的重大翻译需求。业务网络通过用与业务相同的语言描述基础技术，摆脱了断开连接的技术概念。这使得更容易思考世界，并更准确地将思想转化为一个完全运作的系统。

在实践上，这意味着虽然我们对业务网络的初始词汇很简单，但它是一个可以随着时间逐渐丰富的语言的开端，只要它描述了发生在现实世界中的细节和细微差别。我们以后会回到这个想法，但现在让我们从了解参与者开始。

# 介绍参与者

威廉·莎士比亚说，世界是一个舞台，在这个舞台上男人和女人是演员。以类似的方式，业务网络有一个演员阵容——一组相互交互以获得某种形式互惠的演员。我们称这些演员为业务网络中的参与者。例如，教育网络中的参与者可能是学生、教师、学校、大学、考官或政府检查员。保险网络中的参与者可能是投保人、经纪人、承保人、保险公司、保险联合体、监管机构或银行。

参与者的概念对于理解业务网络至关重要。起初，你可能会觉得这个术语有点令人生畏，但实际上没有什么可担心的。理解的关键在于名字——参与者*参与*了业务网络。我们感兴趣的是他们的行动。用不同形式的词来强调他们相互作用的不同方面：参与者、当事人和交易对手，例如。所有这些形式都源自行动的概念。和往常一样，我们发现诗人对世界运作的方式了解一二！

学会喜欢这个词，因为它是一个开启大门的词！这是你理解业务的创立原则的简称——与谁做生意至关重要。但它比这更重要；确定业务网络中的参与者是确定是否有机会从区块链的使用中获益的第一件事情。你需要先了解人员构成，才能真正了解发生了什么。而且，随着你了解参与者之间的互动，你将能够提高对成为特定参与者意味着什么的理解。

# 参与者类型

商业网络中有不同*类型*的参与者，我们将它们分为三大类。令人惊讶的是，我们不会首先描述最重要的类别！

# 个人参与者

希望这个类别是一个相当明显的类别——教师、学生或银行客户都是个人参与者的例子。无论你把它们称为个体、人员，甚至是人类，这个第一个类别是我们直觉上会认为是参与者的，因为我们将它们与自己联系起来。

你可能认为个人是网络中最重要的参与者。毕竟，企业的存在是为了服务个人，不是吗？是的，他们是，但情况比较微妙。虽然商业网络通常存在是为了满足个体最终消费者的需求，但区块链是一种对于网络中的企业更有价值的技术。这是因为它使它们能够更好地协调彼此的活动，从而降低成本，并为最终消费者提供新的商品和服务的机会。这就是为什么你会听到人们说出类似区块链对于 B2B 比 B2C 或 C2C 更重要的句子——他们试图传达的是商业网络的重大成功是将区块链用作高效和创新的企业间交互的普遍基础。

当然，个人参与者也很重要。企业需要了解他们的最终消费者，而最终消费者通常使用商业网络提供的服务与彼此互动。例如，如果我希望通过银行网络向你转账，我们各自的银行就需要知道我们是谁，以便能够正确验证和路由交易。

最后，一个合理的经验法则是，商业网络中认识的个人要比网络中的企业多。这并不令人太惊讶——只是值得指出这一点，以便你对什么是个人参与者的理解是完整的！

# 组织参与者

组织参与者是商业网络中最重要的角色。汽车经销商、银行、学校和保险公司都是组织参与者的例子。当我们首次思考特定的商业网络时，我们会识别这些参与者，然后是它们互相以及最终消费者提供的商品和服务。这些组织参与者为商业网络提供基础设施——使其运作的人员、流程和技术。

虽然组织由个体构成，但在概念上与它们是完全分开的。一个组织有着自己的身份和目的。它以非常实际的方式存在，独立于属于它的个体。组织为商业网络提供了一种永恒感。虽然组织内的个体可能随着时间变化，组织内的个体数量可能增加或减少，甚至组织内的不同角色可能来来去去，但组织保持不变；它是一个比任何个人成员的寿命都要长得多的结构。

关于个体与他们的组织之间关系性质的最后一点需要注意的是，是个体执行组织的功能，如个体的组织角色所定义的。当银行向客户提供贷款时，是银行员工代表银行执行的。通过这种方式，个体是组织的代理人，并且个体的角色决定了它可以执行的任务集。例如，学校教师可以给学生布置家庭作业，但需要学校校长来聘请新教师。简而言之，个体代表组织行事，并且代表该组织的权威。

# 系统或设备参与者

系统或设备参与者代表商业网络中的技术组件。实际上，它们是一种特殊类型的个体参与者，如果你觉得有用，可以这样认为。然而，我们之所以单独将它们列出来，有两个原因。

首先，如今的商业网络中有很多技术组件！例如，有 ERP 系统、支付引擎、预订系统、交易处理器等等。事实上，今天商业网络中的大部分重活都是由这些系统完成的。这些系统与拥有它们的组织相关联，就像我们之前讨论过的个体一样，这些系统代表它们的拥有组织行事——它们也是其代理人。

将区块链纳入商业网络将增加更多的系统参与者，其他参与者（个体、组织和系统/设备）可以与之互动。了解这些区块链系统参与者是很重要的，因为它们将为商业网络提供非常有用的服务！

其次，设备正变得成为业务世界中更为重要的一部分。而且，尽管今天许多设备相对简单，毫无疑问，设备正在获得更多自主特性。我们都听说过预期出现自动驾驶车辆，正是出于这种精神，我们引入**设备参与者**的概念。逐渐重要的可能是将这些设备视为业务网络中更为积极的角色。因此，虽然我们不指望汽车很快就变得智能（不管那意味着什么！），但将这些越来越自主的设备称为网络中的活跃实体而不是被动实体是有帮助的。

# 参与者是代理

我们对参与者类型的考察告诉我们一个共同点——它们都拥有一定程度的主动性——它们积极地做事情。虽然系统和设备的自主程度受其程序和算法的限制，但将它们这样地看待仍然是有帮助的。而且，这些相对自主的参与者之间的交互作用成为业务网络中下一个概念的引导，即**资产**。我们稍后会看到，在参与者之间移动的实体——资产——没有这种自主性。这些都受到参与者施加在它们身上的力量的影响。稍后再详述此点。

# 参与者和身份

最后，但非常重要的是，参与者有**身份**。例如，一个学生有学生证，一个司机有驾驶执照，一个公民有社会保障号码。显而易见，参与者和用于识别参与者的东西之间有区别。而且，将这两个概念紧密联系但分开是非常重要的。

例如，参与者可能有不同的身份参与不同的业务网络——可能是*同样*的银行参与了保险网络和抵押网络，但它在这两个网络中有不同的身份。此外，即使在一个单一网络中，参与者的当前身份可能会被 compromise，允许他们被冒充。在这种情况下，他们被 compromise 的身份将被吊销，并发放一个替代身份供真正的参与者使用，拒绝冒名顶替者，恢复信任。不同身份，但是同一参与者——这就是要传达的信息。

正是因为对冒充的担忧，某些身份会定期被故意过期。例如，X.509 数字证书有一个到期日期，过了这个日期，它们将不再有效。然而，仅仅因为证书已经过期，并不意味着参与者不再存在。

实际上，情况恰恰相反。参与者相对于它的身份的相对永久性意味着它可以用来提供业务网络中谁做了什么的长期历史参考。参与者随时间提供的身份的一致性帮助我们推理业务网络中的交互历史。我们可以不使用参与者的概念就做到这一点——只使用身份，并清楚地了解它们如何以及何时相互之间改变，但这将不那么直观。

关于参与者的内容就到这儿了；你现在是专家了！正如你所看到的，参与者可能是业务网络中最重要的事情，这就是为什么我们花了相当多的时间讨论它们。现在让我们把注意力转向在参与者之间流动的对象，即资产。

# 介绍资产

我们已经看到业务网络是由在其中运作的参与者定义的。这些参与者是在网络中进行有意义交互的积极主体，他们的交易至关重要。现在我们要问自己一个问题，*参与者之间流动的是什么？*答案很简单，是资产。

要理解我们所说的资产是什么，让我们看一些例子。我们注意到，学生从导师那里接收课程作业。同一个学生随后可能向大学展示他们的教育证书。汽车经销商向买家出售一辆汽车。保险公司为投保人提供汽车保险，签发一份保单。投保人提出索赔。这些例子都包含了资产：课程作业、教育证书、汽车、保单和索赔。

# 资产在参与者之间流动

我们可以看到，资产是在参与者之间流动的对象。而参与者有相当大的自治度，资产则相当被动。这种资产的性质是基础的——资产往往对于交换它们的交易对手来说意义重大。这并不是说其他参与者对这些资产不感兴趣，但这确实强调了资产的被动性质。那么，是什么让资产如此重要呢？我们为什么要讨论这些被动的对象呢？

答案就在我们选择的词——资产。资产是一个有*价值*的东西。尽管资产相对被动，但它们代表着在参与者之间交换的价值。再用这种基于价值的视角看一下这些示例资产：课程作业、教育证书、汽车、保单和索赔。课程作业对老师和学生有价值；教育证书对学生和大学有价值；汽车对经销商和买家有价值；保单对保险公司和投保人有价值；索赔对申请人和保险公司有价值。希望现在清楚了为什么资产很重要，以及为什么它们被称为资产！

作为一个小注，不要认为因为我们有资产，我们就必须有负债——我们并不是完全按照这种方式使用这个术语。完全正确的是，如果我们要将对象作为为我们服务或反对我们的对象进行计量，我们将把它们称为资产或负债，但这不完全是这里发生的情况——我们使用资产作为具体名词，而不是作为质量或抽象名词。

# 有形资产和无形资产

让我们通过考虑有形和无形资产来继续了解资产。有形资产是我们可以触摸和感受的东西——汽车、纸币或课程作业。无形资产是诸如抵押贷款、知识产权、保险单和音乐文件等东西。在一个日益数字化的世界中，我们将会看到更多的无形资产。你会听到人们说物体正在变得*非物质化*，而无形资产的概念很好地捕捉了这个概念。

几个小点需要注意，以避免混淆我们对无形一词的使用。首先，由于我们正在处理数字分类帐，在某种微不足道的意义上，区块链上的一切都是无形的。有趣的是对象本身的性质——使用无形这个词可以帮助你记住要注意在物理世界中看不见的东西。

其次，使用无形一词并不意味着对价值的陈述。在会计系统中，当我们难以定义某物时，例如商誉，我们经常使用这个术语。同样，我们并不是用这个词的这个意义；我们的无形资产比这更具有具体、明确和可交换的形式，因为它们是有价值的东西，即使你不能触摸它们。

# 资产的结构

现在让我们重新聚焦，看看资产的结构。资产具有一组称为**属性**的属性集和一组称为**关系**的属性集。属性属性易于理解——它们是对象的特征。例如，汽车有制造日期、颜色和发动机尺寸。或者，抵押贷款有价值、寿命和还款计划。特定资产由特定的一组属性**值**标识。例如，我的汽车可能是 2015 年生产的，是白色的，有 1.8 升的发动机。另一个例子——你的抵押贷款可能价值 10 万美元，寿命 25 年，并且每月付款。区分这种差异很重要——在资产的结构*一般*、**类型**和资产的*特定* **实例**之间。

第二，资产还有一组被称为**关系**的属性。关系是一种特殊类型的属性—它是对另一个资产的引用！你可以立即看出这为什么很重要。例如，一辆汽车有一个保险文件。汽车是一个有价值的对象，保险文件也是一个有价值的对象。此外，保险文件命名了一个保单持有人。在我们的例子中，主体和客体都是资产，并且它们以提供基本含义的方式相互关联。

后面我们会看到，描述或**建模**这些关系是一项极其重要的活动，因为我们在描述世界是如何运作的。在前面的例子中，我们故意犯了一个错误—是的，真的！这是因为在现实世界中，实际上是政策文件是核心，因为它命名了汽车和保单持有人。在建模中，我们称之为关联关系，并且我们将看到为什么正确理解这种事情非常重要。例如，在汽车的性质中，你不会找到保险文件—汽车是在有效的保单文件中命名而被保险的。此外，如果我想要让更多的人驾驶汽车，我会将他们的名字添加到保单文件中，而不是汽车！关于这一点，以后会有更多的讨论—现在，记住资产具有属性和引用，特定对象对这些属性具有具体的值就足够了。

也值得简要提及使资产属性成为属性而不是对另一个资产的引用的性质。一个简单的答案是：当属性变得太**大**时，将它们拆分成资产引用！当然，这是一个非常不满意的答案！为什么呢？因为我没有告诉你什么定义了大！一个更好的答案是，当属性满足单独的关注时，需要引用。这个原则—**关注分离**—是任何系统中的关键设计原则。例如，对于保险政策，政策的有效日期不是一个单独的关注点，但汽车和命名的驾驶员是单独的关注点。这个原则帮助我们独立地思考保险政策、汽车和驾驶员，从而更真实地建模现实世界。最后，在资产的这个方面，属性和关系属性是**领域特定**的—它们与手头问题的性质有关。所以，对于汽车制造商，颜色可能是汽车的属性—但对于油漆制造商，颜色绝对是一种资产类型！

# 所有权是一种特殊的关系。

有一种特定的关系在商业网络中尤为重要，那就是**所有权**的概念。所有权是一种关联关系，例如我们之前讨论过的保险单文件。让我们考虑一个具体的例子——一个人拥有一辆车。车主是车的属性吗？车是人的属性吗？经过一点思考，我们可能意识到，这两种说法都没有捕捉到*拥有*某物的含义。所有权是人和车之间的映射。所有权是一个与车和车主完全不同的概念。

了解这种关于所有权的思考方式很重要，因为在许多情况下，我们通过车或车主来建模所有权关系，而这对许多目的来说已经足够了。但是，所有权关系的*本质*是一种关联关系，意识到这一点很重要——因为区块链经常用于记录商业网络中的所有权和所有权转移。例如，政府经常持有土地或车辆的所有权记录。在这些情况下，考虑的主要资产是所有权关系。当车辆或土地在参与者之间转移时，改变的是这些所有权记录，而不是资产本身。这很重要，因为我们经常对车辆或土地的历史感兴趣，而车辆或土地本身可能不会改变，但它的所有权肯定会改变。因此，清楚地知道我们是在谈论资产的历史，还是在谈论所有权的历史很重要。这些历史通常被称为**溯源**——它们告诉我们谁拥有了一个资产，以及它如何随着时间的推移而改变。这两个方面都很重要，因为了解资产的溯源可以增加我们对其的信心。

# 资产生命周期

这种出处的想法自然地将我们带到了**资产生命周期**的概念。如果我们考虑一下资产的历史，那么从某种非常有意义的意义上讲，资产是被创建的，随着时间的推移而发生变化，并最终停止存在的。例如，考虑一笔抵押贷款。当银行同意向客户借出一笔钱时，它就产生了。它在抵押贷款的期限内存在。随着利率的变化，它根据固定利率或浮动利率确定每月偿还金额。抵押贷款的期限可以在银行和抵押贷款持有人的同意下更改。最后，在抵押贷款到期时，它停止存在，尽管可能会保留其历史记录。如果客户希望提前支付抵押贷款（也许他们搬家了），或者不幸地，如果他们违约了，抵押贷款可能会被提前终止。在某种意义上，我们看到抵押贷款被创建了，期限定期更改了，然后抵押贷款以正常或意外的方式完成了。这种生命周期的概念在业务网络中非常重要，我们将在后面详细讨论它，当我们讨论**交易**时。

回到资产，我们可以看到在它们的生命周期中，资产也可以被**转化**。这是一个非常重要的想法，我们考虑资产转化的两个方面——即转化是否涉及**分割**或**聚合**，以及它是否是**均匀**或**不均匀**的转化。这些术语听起来有点吓人，但它们非常容易理解，并且最好使用每个方面的一个示例来描述。

在第一个例子中，我们考虑了一颗被开采出来的珍贵宝石。一般来说，一颗开采出来的宝石对于任何珠宝商来说都太大了，无法用于制作单件珠宝。它必须被分割成更小的石头，每个石头可以用于制作单件珠宝。如果我们看一下一颗大的被开采出来的宝石的历史，我们会发现它经历了一个分割的过程。最初的资产是一颗宝石，它被转化为一组更小的宝石，每个宝石都与原始宝石相关。我们可以看到资产转化是均匀的，因为尽管更小的宝石绝对是不同的资产，但它们与原始资产是**相同类型**的。类似的均匀转化过程经常发生在无形资产中，例如，当一笔大型商业贷款或保险请求被分散到几家公司中以分散风险时，或者当股票被拆分时。

在我们的下一个例子中，我们考虑使用较小的宝石的珠宝商。我们想象他们使用宝石为客户制作精美的戒指。为了制作戒指，他们运用所有的技能将宝石镶嵌在一个通过肩连接到环上的镶座上。珠宝商的手艺值得赞美——他们将一小块银和一颗宝石变成了一件有价值的珠宝。让我们再思考一下正在考虑的资产。我们可以看到金属块和宝石已经被结合或**聚合**成戒指。我们还注意到戒指是一种不同于作为输入的宝石或银块的资产。我们可以看到这些输入经历了**异质转换**，因为输出资产是不同类型的。

这些聚合和分割过程在许多资产的生命周期中都可以看到。在制造业生命周期中非常流行，但使用无形资产。例如，我们在**并购**中看到它，其中公司可以合并在一起，或者**收购**，其中一家公司通过并入另一家公司而停止存在。**分拆**或**分立**的反向过程被清晰地描述为资产的分割。

# 详细描述交易中资产的生命周期

让我们考虑资产*如何*在它们的生命周期中移动。我们已经学到资产是如何创建、转化和最终停止存在的。尽管生命周期是一个非常有用的概念，但这些步骤似乎有些受限。毫无疑问，对资产在其生命周期中经历的一系列步骤进行更丰富的描述是有可能的。答案是肯定的！**交易**为描述资产随时间演变提供了丰富的、特定领域的词汇。例如，保险单被要求、完善、签署、交付、申报索赔、支付索赔、失效或续约。这个生命周期的每一步都是一个交易——我们将在下一节中更详细地讨论交易。

最后，与资产一样，参与者可以通过交易来描述生命周期。那么，你可能会想，资产和参与者之间有什么区别呢？嗯，这实际上归结为思考形式与功能。仅仅因为资产和参与者都可以通过交易来描述生命周期，并且同样如此，这并不意味着它们是相同的东西。就像鸟类、昆虫和蝙蝠都能飞行一样，它们绝对不是相关的。在一般意义上，我们认为参与者和资产是资源——它们仅在最一般的意义上相关。

这就结束了我们对资产的讨论！正如我们在话题末尾看到的那样，**交易**对于描述资产和参与者的生命周期至关重要，所以现在让我们转向这个主题吧！

# 介绍交易

到目前为止，我们的旅程涉及了理解商业网络的基本特性——即它由参与者组成，这些参与者参与资产的有意义交换。现在让我们专注于商业网络中最重要的概念——交换。

# 变化作为一个基本概念

为什么交换是最重要的理念呢？嗯，没有它，参与者和资产就没有了目的！

这似乎是一个过度夸张的说法！然而，如果你稍微思考一下，参与者只有在彼此交换商品和服务（统称为资产）的意义上才有意义存在。如果一个参与者不与另一个参与者交换，那么他们在任何有意义的方式下都不存在。资产也是一样——如果它们不在参与者之间交换，那么它们也不存在任何有意义的方式。如果资产在不同参与者之间不移动，那么资产具有的生命周期就没有意义，因为该资产对参与者来说是私有的，在参与者的私人背景之外对商业网络没有任何意义。

**变化**，因此，是商业网络中的基本原则。当我们考虑交换、转移、商业、买卖、协议和合同时，所有这些激励性的想法都与商业及其变化的影响有关。变化赋予了商业世界动力和方向。我们捕捉变化的方式是通过交易。这就是为什么交易是商业网络中最重要的概念——它定义并记录了变化——资产的变化；资产所有权的变化；参与者的变化。每当商业网络中发生任何变化时，都会有一笔交易来记录。

# 交易定义和实例

术语“交易”通常有两种密切相关但不同的用法，意识到这种差异很重要。我们有时使用术语“交易”来一般性地描述交易中发生的事情。例如，我们可能定义房地产交易涉及买方支付一定金额给房产所有者，以换取房产的所有权和产权的转移。（几乎总是，买方还获得了随后出售房产的权利。）在这种意义上，术语“交易”用于一般性地描述交换过程，描述参与者和资产涉及的交换过程。

“交易”一词的另一个用法是描述特定交易。例如，我们可能会说，2018 年 5 月 10 日，黛西从温彻斯特自行车店以 300 英镑的价格购买了一辆自行车。我们在这里使用术语“交易”来描述特定交易的一个实例。这两种用法非常密切相关，上下文几乎总是清楚表明我们在谈论哪一种。

两种用法之间的基本区别在于前者定义了交易的含义，而后者捕捉了交易的特定实例。在现实世界中，我们经常看到交易实例的例子——每当我们进入商店购买商品时，我们都会收到收据！在我们之前的例子中，黛西可能为她的自行车收到了一张收据。收据可能是纸质的，尽管现在它经常发送到我们的手机或电子邮件地址。这张收据是交易的副本——它是黛西对发生的事情的个人记录。自行车店也会保存交易记录的副本，以供他们自己的会计目的使用。

# 隐式和显式交易

请注意，像这样的交易通常不会看到显式的交易定义；定义被编码在您与之互动的人、流程和技术中。对于像黛西这样的低风险交易，交易定义是隐式的。只有在存在争议时，我们才能了解交易是如何定义的。例如，如果黛西的自行车链条在几天后断裂，她可能合理地期望链条会免费修复，或者自行车会被更换，或者她会退款。这是黛西确定与温彻斯特自行车店的交易的真实性质的时刻。

看起来这种隐式交易定义只有缺点，但事实上并非如此。首先，每个国家的法律都有关于公平交易的显式概念，这将使黛西在进入交易时有合理的期望。在大多数国家，这被称为诸如《货物销售法》之类的东西，它规定了任何商业交易中涉及的所有交易对手的权利和责任。其次，缺乏显式合同简化了黛西和自行车店之间的互动。鉴于在大多数情况下，自行车在购买后都能表现良好一段时间，收据对于大多数实际目的来说已经足够了。每次进行简单购买时重新陈述每个人都知道的真相既费钱又费时。这种简化是人们经常称之为**减少摩擦**的一个例子。

对于高风险交易或具有特殊条件的交易，情况大不相同——事先明确交易定义至关重要。如果我们再次看 Daisy 的交易，我们会发现，如果存在争议，就会有其他跟进交易—例如，自行车可能已经更换了链条，或在极端情况下，她可能已经拿回了她的钱。我们可以看到，一般来说，我们需要多个条件交易来描述参与者之间对这种交易的满意互动。这意味着如果 Daisy 得到的是一笔抵押贷款，而不是一辆自行车，就有必要指定若干交易和可执行条件。你可能已经听说过一个用来描述这种交易和条件集合的术语——**合同**。

# 合同的重要性

对于高价值资产，拥有一份合同是很重要的。它定义了一组相关的交易和它们发生的条件。合同通常围绕着特定资产类型展开，并涉及一组明确定义的参与者类型。如果你看一份现实世界的合同，它包括了一系列关于实例和定义的陈述。在合同的顶部，所有的资产和参与者将被列出，并注明了特定的价值—比如 Daisy（买方）、Winchester 自行车（卖方）、300 英镑（价格）、2018 年 5 月 10 日（购买日期）等等。只有在所有这些类型到实例的映射都被列出之后，合同才会在这些类型、交易和在这些类型发生的条件下定义，而不涉及特定实例值。这就是使合同在一开始看起来有点奇怪的地方—但一旦你能看到参与者、资产、交易及其相应价值的结构，它们实际上是相当容易理解的，这种结构使它们更加强大。

# 签名

在合同中我们最后看到的是其底部——签名！签名在许多方面是合同中最重要的部分，因为它代表了所有交易对手对其中包含的信息达成一致的事实。当然，在现实世界中我们会看到许多签名。Daisy 的商店收据通常上面有她的签名—可以是实物的，或者是通过私钥的数字签名。在简单交易中，商店的签名实际上是隐含的—他们会在品牌收据上放置交易代码，并保留一份副本用于自己的目的—这满足签名的目的。

然而，对于高风险交易，所有交易方都需要明确签署一份合同。更为明确地，为了确保每个交易方都是*睁大眼睛*参与合同，可能需要一个独立的第三方，如律师、公证人或监管机构，签署合同以验证明交易明确涉及的各方自愿而自由地参与其中。

# 多方交易处理的智能合约

彻底理解这些概念是绝对至关重要的。它们并不特别复杂，特别是如果你将它们与你每天做的事情联系起来！当涉及理解区块链如何帮助多个交易方创建并就高价值资产相关低摩擦交易达成一致时，我们需要理解这些术语及其重要性，无论是作为独立存在还是相互关联。

现在，当我们看一个商业网络时，我们可以看到它充满了由合同管理的多方交易! 这就是为什么交易是商业网络中最重要的概念；它们定义并捕捉了不同交易方之间有价值资产的约定交换。

现在，让我们来使用一个你在谈论区块链时可能听过很多次的术语——**智能合约**。它们只是这些概念的数字化表现。智能合约是合同的数字形式——意味着它们可以被计算机系统轻松解释和执行。实际上，所有实现高风险或低风险交易的计算机系统都实现了合同。但是，不同于区块链，这些系统没有内建具有使这些概念转化为技术平台的词汇表。

# 数字交易处理

正如我们在本章的开头所提到的，这就是基于区块链实现的商业网络的大思想。它们使得从现实世界到计算机系统的转换尽可能简单。尤其是 Hyperledger Fabric 将所有这些想法都表现得非常明确，这样我们就可以轻松地对商业网络进行建模和实现。它保持所有现有概念完整，但是以基本上**数字**的方式实现它们——使用计算机进程、网络和存储。

交易是商业网络的核心，因为它们作用于资产和参与者。然而，它不仅仅如此。即使我们向商业网络添加更多概念，它们仍然必须始终受到交易的约束。交易性是涉及商业网络所有方面的通用属性。这就像我们在本章前面提到过的能够飞行的能力——商业网络中的每个对象都受到交易的约束，并且必须是交易的主体。

# 发起交易

暂时停下来，我们可以看到交易通常是由业务网络中的一个参与者发起的。这个参与者通常是从特定服务提供商那里获得服务的消费者。例如，黛西希望在购买自行车时消费 Winchester bicycles 提供的服务。

大多数参与者发起的交易涉及资产状态的变化，但在某些情况下，交易可以涉及参与者状态的变化。例如，如果我通过正式文件更改我的姓名，那么从某种意义上说，被转变的资产就是我——参与者。这强调了交易的核心特性——无论对象如何，它们都捕捉到变化。

# 交易历史

当我们之前讨论资产的来源时，我们看到资产的历史很重要——它为网络中的参与者提供了信心，并增加了信任。同样，交易历史也很重要，因为它也增加了信任。为什么？嗯，这归结于那些签名。任何变化都必须得到涉及交易的所有参与者的同意，而每个交易中的签名提供了信心，即每个交易方都同意了交换。交易历史更好——它显示了在所有时间点，网络中的每个参与者都同意了每笔交易描述的每个变化！

区块链历史包含一系列交易的顺序。尽管顺序似乎意味着交易按时间顺序发生，但这只是部分正确的。例如，如果我在上午 11 点向我的银行账户存钱，然后在上午 11 点 30 分从我的银行账户支付款项，那么第一笔交易发生在第二笔交易之前是非常真实的。

同样，如果你在上午 11 点向你的银行账户存钱，然后在上午 11 点 30 分支付款项，你的交易就有了明确的顺序。但是，现在让我们问一下，我们的上午 11 点的交易是先发生还是后发生的？或者我们的上午 11 点 30 分的交易呢？即使在某种意义上，我的上午 11 点的交易在你的上午 11 点 30 分的交易之后记录，这是否重要？

# 交易流

这个例子告诉我们，在讨论交易历史时，交易的依赖性是重要的；依赖于先前交易的交易在其之后记录。对于**独立交易流**，这种排序就不那么重要了。我们必须小心一点，因为交易有一个讨厌的习惯，就是它们会彼此纠缠在一起。例如，如果你的上午 11 点 30 分的交易将款项支付到我的银行账户，那么两个看似独立的交易流就开始相互干扰了。这意味着我们不能随意延迟交易的记录。

请注意，我们谈论的不是交易的实际发生——在特定时间或特定地点——而是该交易记录在交易历史中。这有点像一本奇怪但全面的历史书，记录了拿破仑在 1800 年前往意大利的行程，同时也记录了 1800 年美国国会图书馆的成立，以及日本人物本居宣长完成的文学作品《古事记传》。重要的是这些事件被记录下来——它们在书中相对于彼此的顺序并不是至关重要的，只要它们大致同时出现即可。

# 将交易分开到不同的商业网络

这个看似刻意的交易历史例子实际上为我们提供了对商业网络设计的深刻见解——复杂交互网络中所有互动的一条记录并不是一个好主意。这个例子开始说明，将商业网络与特定关注点相关联可能是更好的设计，而不是试图将所有历史记录合并到一个网络中。在我们的类比中，最好为法国历史、美国历史和日本历史各有不同的历史书，并相互交叉参考！

这个想法对于如何处理区块链网络有具体且重要的影响。将商业网络分开成不同的关注点，并将它们链接在一起不仅是良好的设计，而且是必要的设计。这将导致更简单、更易理解、更可扩展、更可扩展和更具韧性的系统。你将能够从小处开始，然后逐步发展，并且有信心无论事物如何演变，你都能应对变化。你将看到 Hyperledger Fabric 明确支持使用称为网络和通道的概念的多个商业网络的想法，我们稍后会更详细地讨论这些内容。

# 交易历史与资产状态

更详细地审视商业网络历史，我们可以看到一个资产（或参与者）历史的两个元素，即其当前值和导致该值的一系列序列化交易。如果我们按照影响它的所有交易依次从任意时间点进行应用，我们可以生成资产在所有时间点的价值。事实上，我们将交易历史视为一系列在商业网络中不同时间和地点发生的交易**事件**，从而确定其在任何给定时间点的状态。

我们将在 Hyperledger Fabric 中通过账本**世界状态**和账本区块链的概念明确表达商业网络的这两个方面。世界状态保存了商业网络中资产的最新值，而区块链则保存了商业网络中所有交易的记录。这使得 Hyperledger Fabric 比其他区块链更强大一些——像它们一样，它记录了区块链中的所有交易。此外，它还计算了资产的当前值，使得非常容易确信你正在处理最新的状态。这些最新的值往往是最重要的，因为它们代表了世界的当前状态。而且，当涉及到发起新交易时，大多数参与者都对此感兴趣。

# 商业网络作为交易历史

从一个非常真实的意义上来说，我们可以将商业网络视为交易的历史。我们这样说是什么意思呢？好吧，我们已经看到，商业网络由参与多方交易资产交换的参与者组成，这些交易由合同定义。然而，如果我们稍微重新调整一下自己的思路，我们会发现，网络是其交易历史的产物，而这又与发起交易的资产和参与者无法分开。

所有这些概念都是一个整体的组成部分，彼此支持和加强。参与者只是我们理解的第一步——进入商业网络世界的入口。通过学习更多，我们意识到交易实际上是中心，同时也是毫无意义的，除非它们涉及到网络内部的资产和参与者，它们既创造又改变并描述了！正是交易历史将一切联系在一起形成一个连贯的整体，从这个意义上说，它就是商业网络。

# 监管机构和商业网络

关于一种特殊类型的参与者的最后一句话，这种参与者几乎在每一种商业网络中都很常见——**监管机构**。大多数商业网络的性质是存在一种角色的参与者，其职责是确保交易遵守某些**规则**。例如，在美国，**证券交易委员会**（**SEC**）确保执行涉及证券资产的交易的参与者按照约定的法律和规则进行，使投资者对股票市场充满信心。或者，在英国，**驾驶员和车辆许可局**（**DVLA**）确保车辆按照英国法律进行适当的保险、税收和交换。另一个例子是在南非，**南非食品科学与技术协会**（**SAAFoST**）确保涉及农业、食品分销、食品加工和食品零售的交易符合适当的南非法律。

每个商业网络都有某种形式的监管机构来确保适当的监督。简单来说，监管机构确保每个人都按照商业网络的规则来玩游戏。我们可以看到，在所有交易都以数字形式记录在区块链上的商业网络中，监管机构实际上可以更有效地和及时地执行他们的工作。

当然，人们可能会问，如果所有交易对适当授权的参与者都可见，并且能够证明行为的正确性或错误性，那么我们为什么需要监管机构呢？答案是监管机构有权制裁网络中的某些参与者——特别是将他们排除在网络之外，并没收他们的资产或非法交易的资产。这些制裁是网络中最强大的交易，因为它们提供了最终的权力，并且必须仅在极端情况下使用。

祝贺！既然你已经走到了这一步，你真正理解了商业网络的基本性质。更好的是，我们在讨论商业网络时真正需要涵盖的概念只剩下一个：事件。让我们继续讨论你会发现非常有力的商业网络的最后一个方面。

# 从使用 Composer 设计商业网络的角度讨论事件

到目前为止，我们已经看到商业网络的词汇包含一组紧密联系的概念——参与者、资产和交易。尽管数量不多，但这些概念非常具有表现力——它们包含着重要的想法，有许多方面支持和加强彼此。

并不是说有什么*缺失*，而是通过添加一个额外的概念，我们将显著增加这个词汇的描述和设计能力。这个最后的概念是**事件**——混合物中的最后一种成分！好消息是，你可能以前听过这个术语，并且它支持的许多想法是相当明显的。但不要误解，事件是一个非常强大的概念，值得花点时间来掌握——你对这个话题的投资将得到丰厚的回报。

# 一个通用的概念

我们将事件视为表示特定事实发生或发生的事件。例如，*总统抵达澳大利亚*，或者*股市今天收盘上涨 100 点*，或者*卡车抵达配送中心*都是事件的示例。基本想法似乎相当简单——事件是发生重要事情的时刻。事件代表某种过渡——将世界从一个状态转移到完全不同的状态。这就是事件的本质——历史从一条平滑的线变成了一组连接的点——其中每个点代表一个重要事件。

在商业网络领域，我们可以随处看到*事件*。发起交易的参与者算作事件。资产经历一系列变化也算作事件。同样地，资产在参与者之间交换也算作事件。资产的生命周期不过是一系列事件的历程！我们现在看到参与者加入和离开业务网络也算作事件。考虑一下交易历史，我们把它看作关于参与者和资产的一系列事件。天哪，一旦我们睁开眼睛，事件真的无处不在！如果我们不小心，这些小空间入侵者会让我们不知所措！

# 消息携带着事件通知

我们将消息视为事件通知的载体。在现实世界中，我们通过短信、电子邮件或可能是新闻源接收到事件的通知。因此，我们区分事件和其通信。这是一个非常重要的区分，因为它说明我们通过媒介与事件耦合在一起。

让我们现在种下这个想法——我们之后会回到这个想法——即使有一个单独的事件，多个参与者可以通过单独的消息通知。我们看到事件生成者和事件消费者之间存在松散耦合。这一切意味着事件具有稍微难以捉摸的特质——它们稍微抽象的本质使它们难以捉摸，除非通过感知它们的消息。

现在可能需要有点小心了——如果我们过于沉迷于事件，就会失去对重要事情的关注。首先，显而易见的是，我们只需要考虑重大事件——可能会导致某种行动的事件。除了事件之外的一切都只是噪音——我们不需要考虑它。当然，什么算作重大事件将是与领域和问题特定相关的——在金融网络中，股市价格的上涨是重大的，但在教育网络中不是。所以现在，让我们把事件作为一种工具，用于在商业网络中发生重大事情时，当我们需要了解是什么促使参与者行动时。让我们看看如何利用这个工具。

# 一个例子阐述事件结构

以股票市场事件为例。每当一支股票的价格上涨或下跌，我们可以将其表示为一个事件。例如：

| **在 UTC 时间: 2018-11-05T13:15:30:34.123456+09:00 ** **股票 MZK 从 13000 日元上涨了 800 日元** |
| --- |

我们可以看到，这是一个关于股票 ABC 在 2018 年 11 月 5 日某个非常特定的时间上涨了 800 日元的事件描述。

就像资产和参与者一样，我们可以看到术语“事件”既可以指事件的类型，也可以指事件的实例。在我们的示例中，我们将类型和实例信息合并在一起。该事件具有类型**股票市场** **标记**，结构包括**时间**：2018-11-05T13:15:30:34.123456+09:00，**符号**：MZK，**货币**：JPY，**前值**：13000，**变化**：+800。对于结构中的每个元素，我们显示了此事件的特定实例。从这个事件中，我们可以清楚地看到以结构化形式发生了什么。

# 事件和交易

我们可以看到，事件与交易密切相关。事实上，因为事件通常描述一笔交易，因此常见到这些术语互换使用。然而，事件描述的活动类别比交易更广泛。具体来说，事件描述了一种变化，而交易则捕获了变化的记录要素。交易往往是**外部事件**的结果——这是不由特定参与者或资产行动引起的事件。在这种情况下，所产生的交易使用外部事件的信息子集作为输入。但是，事件本身不是交易的一部分，除了在这种有限意义上。这需要一点思考——我们真的在剖析一些微妙但重要的差异。

在可能看起来是矛盾的情况下，交易也可以生成事件！天哪，这似乎变得很复杂！但是想一想——事件只是描述某事发生的情况，有时事件是由交易显式创建的，而不是由任何交易之外的力量引起的。在我们的股票标记示例中，交易可能会生成一个事件，以表示 MZK 股票在单个标记中增长超过 5％！这个事件可能是**快速股票上涨**，其结构为**符号**：MZK，**增益**：*6.1％* ——它是由交易*显式*生成的。交易体现了业务流程的一部分，即识别和传达高百分比股票变动。这个事件在很大程度上实际上是交易的一部分。

# 外部事件与显式事件

因此，我们可以看到，事件分为两类——**外部事件**和**显式事件**。我们不经常将这两个术语视为对立的，但它们完美地描述了业务网络中的两种不同类型的事件。我们的第一种事件类型是**外部事件**——它是在业务网络外部生成的。此事件将由参与者处理，因此可能会导致交易——不要忘记，只考虑重要事件——会导致行动的事件。对于外部事件，大部分事件内容都被捕获为交易输入，但除此之外的事件内容都不会被记住。如果我们想要保存一个外部事件，我们会生成一个显式交易来执行此操作。

**显式事件**有所不同。因为它们在交易中生成，所以它们自动成为交易历史的一部分。当交易提交到账本时，这些事件将被释放到网络中 - 在那里它们将被任何对它们感兴趣的参与者消耗。在显式事件的情况下，总账本本身就是事件的产生者。

# 事件引起参与者采取行动

因此，我们可以看到事件之所以重要，是因为它们标识了导致参与者采取行动的变化！就像在现实世界中一样，当事件发生时，人们和组织会得知它，处理其中的信息，并因此产生行动。我们可以看到，事件为参与者采取行动提供了主要的激励刺激之一 - 通常是通过发起新交易，有时是通过生成新事件。

# 松耦合设计

现在让我们回到松耦合的想法。事件生产者和事件消费者并不直接了解彼此 - 它们被称为松耦合。例如，当一个参与者被添加到业务网络时，现有参与者不需要联系新加入者介绍自己。相反，现有参与者如果感兴趣，就会监听新的参与者事件。同样，如果一个参与者加入一个网络，它不需要联系每个它感兴趣的人和事物，它只是监听它认为重要的事件 - 这些事件可能会导致它采取行动。我们可以看到事件生产者和事件消费者并不明确地了解彼此 - 他们只知道事件 - 因此，通信可以非常容易地增减 - 它更具可扩展性。

现在我们看到，松耦合是事件和交易之间的一个主要区别。交易明确将参与者绑定在一起 - 在交易中，我们命名所有的交易对手。在事件中，我们根本不知道生产者和消费者之间是否以及如何相关。从设计的角度来看，这意味着我们可以创建一个非常灵活的系统。通过事件，参与者可以以几乎无限灵活的方式相互耦合，这确实反映了我们在现实世界中看到的丰富性。

# 事件的效用

现在我们知道为什么我们将事件添加到了业务网络的定义中。事件使业务网络几乎具有无限的灵活性。欣赏这一点混沌 - 在某种意义上，这可能是不太可分析的，但没关系。现实世界本来就不可分析 - 事件为参与者之间提供了高效的协调机制，以便重要的变化通过多方交易得到协商和记录。

恭喜！记得业务网络的定义吗？

业务网络是参与者和资产的集合，经历由交易描述的生命周期。当交易完成时，事件发生。

我们意识到这几句话可能比起初显得更加强大——它们描述了一个非常丰富的世界。让我们做一个实例来看看这些想法是如何发挥作用的！

# 实施商业网络

我们已经在商业网络的世界里游览过了，并且看到了多方参与者之间资产的多方交易处理的重要性——这正是这些网络的生命线。事实上，由于当今商业网络的重要性，已经有大量技术被应用于它们的追求。如果你在 IT 领域工作过一段时间，你可能已经听说过**企业对企业**（**B2B**），甚至可能已经听说过**电子数据交换**（**EDI**）[协议]。这些术语描述了企业之间如何交换信息的想法和技术。你甚至可能听说过，或者有过，如 AS1、AS2、AS3 和 AS4 这样的网络协议。这些定义了两个组织之间如何交换业务数据的标准机制。如果你没有听说过这些术语也不要担心——关键的要点是，商业网络在今天在一个非常实质的意义上存在，并且有很多技术应用于它们。

实施商业网络意味着什么呢？嗯，当涉及到诸如汽车或设备或重要文件等有形资产的交换时，区块链会在商业网络中捕获资产、参与者、交易和事件的表示。但是，对于无形资产来说，情况有所不同——在某种意义上，资产的不断去物质化意味着它们在计算机系统内的表示与资产本身一样真实。

# 去物质化的重要性

考虑音乐的情况。一百年前，音乐可能会记录在*黄麻胶*上，然后通过一系列技术创新，转移到黑胶唱片、CD、数字迷你光盘。每一步都比上一步便宜，质量更高。但是，大约 25 年前，发生了一些不同的事情！第一个 MP3 格式被引入以支持高保真音频捕获。

这是去物质化的一步，与其他步骤完全不同。是的，它更便宜，质量更高，但至关重要的是，它停止了音乐的物理表现形式。这种去物质化模式越来越普遍——金融产品如债券、证券、互换、抵押贷款等主要是以数字形式表示的。越来越多的文件和表格正在数字化——从飞机和火车票等琐碎的例子，到更重要的教育证书、就业和健康记录。这种向数字化的转变意味着区块链比我们可能想象的更具相关性。

所以，当我们在区块链上实施商业网络时，通常会接近处理商业网络中的实际资产。而且，可以说即使在有形资产的情况下，关于资产的信息和资产本身一样重要！这似乎有些夸张，但请稍作思考。假设你拥有一辆车。这辆车需要加油，需要交税，需要维修和投保。它需要每年检测以确保上路安全性。你的车周围有许多经济活动！这意味着关于车辆的信息非常宝贵—事实上，在汽车的寿命内，总运行成本通常是汽车成本的两倍。也许关于车辆的信息比车本身更有价值！？

# 区块链在 B2B 和 EDI 方面的益处

区块链可以为跨多个组织的**企业对企业**（**B2B**）信息处理提供更简单、更全面的方法。而**电子数据交换**（**EDI**）协议仅关注信息的交换，区块链可以在分类帐中存储数据，通过智能合同处理数据，以及通过共识**通信和交换**数据。区块链提供了对多方交易处理的整体方法。在区块链中，业务网络中的所有处理、数据和通信都可以从一个连贯的系统中访问。这与传统的 B2B 方法形成对比，传统方法中数据、处理和交换由不同的系统管理。这种分离直接导致了在这些系统之间加入信息的重大处理量，以及整体透明度的缺乏。这个过程被描述为**协调**—确保业务网络的不同部分之间没有重大差异—这是及时和昂贵的。

我们现在看到了在区块链上实施企业网络的好处。与记录资产的一组不同系统以及在其上运行的不同程序相比，现在有了资产及其完整交易生命周期的共享视图。区块链为资产及其生命周期，参与者、交易和事件提供了明确的共享理解。区块链的这种共享性通过增加透明度而增加了信任，并且彻底简化和加快了处理。例如，组织不必定期与其他对手进行协调，以确保他们的系统吻合—因为在区块链中一切始终吻合。

那么，假设我们希望获得区块链对多方交易处理的益处—我们该如何做呢？这将是我们在本章剩余部分关心的事情—基本的架构方法，但主要是设计工具，您可以使用这些工具在商业网络中实现区块链技术平台。

# 与区块链进行交互的参与者

首先，哪些参与者与区块链进行交互？首先要说的是，在企业网络中，区块链的主要受益者是持有最多数据的参与者，通常是组织。这并不是说个人不能保存区块链账本的实例，但更有可能的是他们将与管理部分区块链的组织进行交互。实际上，他们甚至可能都不知道自己在使用区块链。在组织内部，虽然是个体使用应用程序与区块链进行交互，但至关重要的是，他们是代表组织行事的——他们是组织的代理人。

同样，当涉及到系统和设备参与者时，设备很少会保存区块链账本的副本。这样，设备更像是个体参与者一样。相反，网络中的系统可以代表组织行事，或者在某些情况下，实际上代表组织。那么，系统代表组织意味着什么呢？如果我们想象一个 B2B 系统，那么组织在网络中看起来真的就像是它的 B2B 网关，实质上，网关就是这个组织。这样看来，一个大型系统与区块链账本实例之间有很密切的关联是有道理的。

# 通过 API 访问业务网络

组织、个人、系统和设备通过一组业务网络 API 与区块链进行交互。我们马上就会看到这些 API 如何创建，但现在知道区块链网络就像普通的 IT 系统一样被消费。差异在于内部——这些 API 是在区块链基础设施上实现的，最终提供了比实际上可能实现的更简单和更丰富的 API 集。然而，区块链 API 的使用者不需要担心这些——他们只需发出 API，并且所需的服务就会自动执行。正在发生的折衷是，区块链基础设施需要业务网络中的组织之间进行更多的协调。他们必须事先就参与者、资产、交易和事件达成一致，以及它们的发展方向。虽然他们在区块链外部可以唯一地处理、存储和传递信息，但他们必须在区块链上达成一致。这就是折衷：前期一致性换取正常运行时业务流程的极端简化的承诺。

从高层次来看，业务网络 API 很容易理解。在车辆网络中，我们可能有诸如 `buyVehicle()`、`insureVehicle()`、`transferVehicle()`、`registerVehicle()` 等 API。这些 API 是领域特定的——刚刚提到的 API 与商业票据网络中的 API `issuePaper()`、`movePaper()` 和 `redeemPaper()` 完全不同。API 必须是领域特定的，因为这样可以使它们对使用它们的网络中的参与者有意义——这些 API 讲述了参与者的语言。

# 一个 3 层系统架构

这些 API 在一个非常标准的系统架构内运作。通常，最终用户将在其 Web 浏览器或移动设备上运行一个展示层。这将与应用程序服务器层进行通信，使用根据正在开发的整体解决方案定义的 API。这个应用程序层可能在云中运行，也可能在本地系统上运行。这是应用程序的所有应用逻辑所在的地方，它是由区块链提供的业务网络 API 的消费者。该应用程序可能会执行其他工作，比如访问数据库或执行分析，但从我们的角度来看，它是与区块链网络的交互点。它使用区块链 API，而不是最终设备。总的来说，这些 API 在典型的 3 层系统架构结构中运作，包括展示层、应用程序层和资源管理层。

或者，如果我们有一个设备或系统与区块链进行交互，那么它将没有展示层——它将直接使用应用程序 API 或区块链 API。从某种意义上说，设备是展示层，而系统是应用程序层。同样，这是非常标准的。

# Hyperledger Fabric 和 Hyperledger Composer

基本的设计方法同样非常简单。我们使用 Hyperledger Composer 对特定的业务网络中的参与者、资产、交易和事件进行建模。然后，我们使用该模型生成区块链智能合约和账本，实现这些元素，并将其部署到使用 Hyperledger Fabric 创建的区块链网络上。我们还使用 Hyperledger Composer 模型生成一组领域特定的 API，以访问在 Hyperledger Fabric 区块链中操纵它们的交易。正如我们所见，这些 API 将由应用程序代表个人、组织、系统和设备使用。

# 摘要

在本章中，我们已经介绍了业务网络并对其进行了详细的探讨。通过理解参与者、资产、交易和事件的关键组成部分，我们已经看到，在某种意义上，所有的业务网络都共享相同的关注点。

通过对不同类型的参与者进行分类——个人、组织、系统和设备，我们能够正确描述谁发起捕捉业务网络变化的交易。通过理解资产的概念——有形或无形的价值物品，我们能够描述和理解在参与者之间流动的资源，以及它们表达参与者相互交互的原因。理解参与者和资产使我们能够理解如何在交易中捕捉这些变化。最后，事件的概念使我们能够理解网络发生重大变化的时候，并对其采取行动。

我们花了一些时间讨论这些概念是如何使用 API 消耗的，在接下来的章节中，我们将更加专注于这个方面——如何在一个商业网络的真实示例中展示所有这些想法。我们将特别使用 Hyperledger Fabric 和 Hyperledger Composer，这样你就可以看到如何将这些想法应用于实践。
