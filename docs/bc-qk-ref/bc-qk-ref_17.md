# 去中心化应用程序

**去中心化应用**（**DApps**）是在去中心化网络上运行的应用程序，不受集中式权威机构的拥有或控制。它们与分布式应用程序主要在所有权方面有所不同。分布式应用程序可能在成千上万台计算机上运行，但这些计算机和运行在它们上面的软件的管理受到中央机构的控制 - 亚马逊、微软等。去中心化应用程序运行在通常是点对点网络上，并且设计得以一种使得没有任何人或组织可以控制应用程序功能的方式。去中心化应用程序不需要区块链。在区块链之前有多个去中心化应用程序：BitTorrent、Tor 和 Mastodon 都是没有使用区块链而存在的去中心化应用程序。

在本章中，我们将涵盖以下内容：

+   去中心化应用程序的主要特点

+   当今运营的最大的去中心化应用程序

+   非基于区块链的去中心化应用程序

本章的目标是让您了解去中心化应用程序及其开发，以及让您了解已经存在的生态系统和代码。如果您有兴趣构建去中心化应用程序，与已经存在的生态系统的互操作性将极大地提高您的成功机会。

让我们首先看一下是什么使一个应用程序去中心化。

# 什么使一个应用程序去中心化

在本书的前面，我们讨论了分布式与去中心化系统。分布式系统是由许多计算机组成的系统，系统的工作分布在所有这些机器上。通常，分布式网络中的计算机被放置在不同的地理区域，以防止系统受到停电、自然灾害或军事事件等停机的影响。去中心化网络不仅在地理上分布，而且在权威和控制方面也是如此。例如，亚马逊云这样的分布式系统可能在全球范围内，但仍然受到中央机构的控制。而去中心化系统则没有中央权威。

# 定义去中心化应用程序

一个关于基于区块链的去中心化应用程序的知名资源是由大卫·约翰逊撰写的名为*去中心化应用程序、DApps 的一般理论*的白皮书。在这篇白皮书中，他确定了成为 DApp 的四个关键标准：

1.  应用程序必须是完全开源的；它必须自主运行，并且没有任何实体控制其大部分代币。该应用程序可以根据提出的改进和市场反馈来调整其协议，但所有变更必须由其用户的共识决定。

1.  应用程序的数据和操作记录必须以加密方式存储在公共、去中心化的区块链中，以避免任何中心化的故障点。

1.  应用程序必须使用加密代币（比特币或其系统内部的原生代币），这对于访问应用程序和任何矿工/农民贡献价值都是必要的，并且应该用应用程序的代币奖励。

1.  应用程序必须根据标准的加密算法生成代币，作为节点为应用程序做出的贡献的价值的证明（比特币使用 PoW 算法）。

然而，这个定义非常狭隘。大卫只考虑了在区块链上运行的去中心化应用程序，而且只考虑了可以通过代币激励的应用程序。有许多早于区块链的去中心化应用程序，并不使用或需要代币。在本章中，我们将讨论区块链和非区块链的去中心化应用程序，但重点是与区块链生态系统相关的应用程序。我们还将讨论那些虽然在去中心化网络上运行，但并不是去中心化的区块链应用程序。

对于本书，我们将使用以下四个标准来描述一个去中心化的应用程序：

+   应用程序必须是完全开源的。

+   应用程序必须自主运行，没有个人、组织或组织团体控制应用程序的运行。应用程序可以根据提出的改进和市场反馈调整其协议，但所有更改必须由其用户共识决定。

+   应用程序的数据必须以公开的、去中心化的方式存储，可以进行检查，没有单一的故障点。

+   应用程序必须提供一种方式，来调整所有关键用户群体对应用程序使用的激励。

正如你所见，这个简化的定义保留了去中心化的所有关键原则，而不依赖于区块链或代币，因为有许多方式可以构建或使用带有或不带有区块链的去中心化应用程序。当我们看到 IPFS 时，就会发现完全可以在没有区块链的情况下拥有去中心化的应用程序，并且可以有激励而不需要代币。

# 去中心化应用程序与区块链

去中心化应用程序是一个特定目的的去中心化系统。例如，虽然以太坊是一个去中心化网络，因为任何人都可以加入，节点都是对等的，但去中心化应用程序将在网络之上运行，为用户提供特定的服务或一组服务。在某种程度上，这种区分是没有意义的——你可以把以太坊看作是提供智能合约服务和本地代币转账的分布式应用程序。无论如何，关键的区别在于权力。

# 使用区块链并不意味着应用程序是去中心化的

一个单一实体或小团体对应用程序拥有更多权力，它就越是中心化的。任何一个群体对应用程序的命运和功能控制力越小，它就越是去中心化的。正如去中心化应用程序不需要区块链一样，运行在区块链上也不意味着应用程序是去中心化的。这意味着今天在区块链上运行的许多应用程序可能仍然不是真正的去中心化应用程序。即使应用程序完全开源也是如此。

为了说明，让我们考虑一个小型示例应用程序`SpecialClub`，用 Solidity 编写。它非常简单，只是保持一个成员列表（存储为地址），这些成员是`Special Club`的一部分：

```
pragma solidity ⁰.4.23;

contract SpecialClub {
    // Centralized owner of this application
    address public owner;
    // we set members to true if they are a member, false otherwise.
    mapping(address => bool) public members;
    mapping(address => bool) internal requests; 

    constructor() public {
        owner = msg.sender;
    }

    modifier onlyOwner() {
      require(msg.sender == owner);
      _;
    }

    function approveMembership(address _address) onlyOwner external {
        members[_address] = true;
        requests[_address] = false;
        emit GrantedMembership(_address);
    } 

    function requestOwnership() external {
        requests[msg.sender] = true;
        emit RequestToJoin(msg.sender);
    }

    event RequestToJoin(address _address);
    event GrantedMembership(address _address);
}

```

尽管这段代码是用 Solidity 编写的，并且部署在区块链上，但它是完全中心化的。它仍然是分布式的，因为如果部署，成员列表将被公开分布到整个以太坊网络中。然而，控制权仍然掌握在一个地址上——`所有者`。`所有者`地址对谁有资格被添加到`SpecialClub`成员名单拥有绝对控制权。任何基于此成员列表的进一步功能通常会因此而集中化。一个继续存在的优势是透明度——通过将代码和其状态都写入区块链，每个人都清楚规则和成员列表。然而，要成为真正的去中心化应用程序，该应用程序需要进行修改，以便例如现有成员可以投票决定接受或拒绝谁。

这是一个非常基本的示例：

```
pragma solidity ⁰.4.23;

contract SpecialClub {
    address public owner;
    // we set members to true if they are a member, false otherwise.
    mapping(address => bool) public members;
    mapping(address => bool) internal requests;
    mapping(address => mapping(address => bool)) votedOn;
    mapping(address => uint8) votes;

    constructor() public {
        owner = msg.sender;
    }

    modifier onlyOwner() {
      require(msg.sender == owner);
      _;
    }

    modifier onlyMember() {
        require(members[msg.sender] == true);
        _;
    }

    function approveMembership(address _address) onlyOwner external {
        members[_address] = true;
        requests[_address] = false;
        emit GrantedMembership(_address);
    } 

    function requestOwnership() external {
        requests[msg.sender] = true;
        emit RequestToJoin(msg.sender);
    }

    function voteInMember(address _address) onlyMember external {
        //don't allow re-votes
        require(!votedOn[_address][msg.sender]);
        votedOn[_address][msg.sender] = true;
        votes[_address] = votes[_address] + 1;
        if (votes[_address] >= 5) {
            members[_address] = true;
            requests[_address] = false;
            emit GrantedMembership(_address);
        }
    }

    event RequestToJoin(address _address);
   event GrantedMembership(address _address);
}
```

这个版本允许如果至少有五个现有成员投票赞成，新成员可以被添加进来。虽然这样的应用程序一开始是中心化的，但在五名成员之后，所有者将不再能够对成员名单施加任何控制。随着时间的推移，去中心化的程度将增加。

# 主要的去中心化区块链应用程序

假设本书的读者可能正在考虑启动自己的去中心化应用项目或为现有项目做贡献。在构建新的去中心化应用程序时，重要的是要意识到已经存在的内容，以便您的应用程序可以利用现有的功能。目前有许多运行和生产的现有去中心化应用程序，并且已经经历了大量开发。一般来说，这些应用程序提供服务，以帮助其他去中心化应用程序蓬勃发展。此外，这些应用程序都是开源的。如果您评估其中一个项目并发现它缺少某些内容，则通常需要的努力较少，以便为现有功能做出贡献或贡献给其他功能。

# IPFS

**IPFS**代表**星际文件系统**。IPFS 旨在成为一种可以从 Web 访问的分散式点对点文件系统。IPFS 是一个分散式应用程序，但不涉及区块链。相反，它使用了一种称为**有向无环图**或**DAG**的相关技术。

# 典型的 Web 通信

要理解 IPFS，最好从典型的 Web 通信方式开始，然后建立区别。在普通的 Web 通信中，有两个主要角色：客户端和服务器。服务器托管应用程序、文件等，客户端连接到服务器。客户端通常不会彼此连接。如果两个客户端进行通信，它们会首先连接到服务器，让服务器充当中间人。

这种方法易于理解，并且企业已经学会了如何可靠地扩展它。企业可以转向像亚马逊网络服务这样的服务，或者使用诸如 OpenStack 之类的软件，通过增加服务器容量来处理大量流量。

然而，这种方法也非常低效。例如，想象一下，一个建筑物里有 10 个人都在自己的笔记本电脑上观看同一部电影。与其让所有 10 个客户端都访问服务器并下载 10 份副本，为什么不让每个客户端下载电影的 1/10，然后与其他人分享呢？这样可以大大降低总带宽，并且类似地提高速度。

# 点对点文件传输

这种由对等方下载单个文件的不同片段然后分享的方法是一种称为 BitTorrent 的技术的核心。BitTorrent 允许对等方相互交换文件和文件片段。这种方法的缺点是几乎没有动机不下载你想要的文件，然后断开连接，从而阻止其他人做同样的事情。为了避免这种情况，IPFS 从 BitTorrent 协议中汲取了灵感，并将其概括为一种称为**Bitswap**的技术。Bitswap 的工作方式类似于 BitTorrent，但受到了比特币及其工作证明激励系统的进一步启发。Bitswap 具有自己的激励系统，如果客户端下载并存储稀有数据——即在网络上尚不高度可用的数据——以保持全球可访问性高。

# 区块链项目的价值

尽管区块链提供了一种分散式的价值和数据交换方法；但并不适合存储大文件或内容，如图像和视频。考虑到现代客户和网络用户的期望，这是一个真正的问题。这些类型内容的大多数存储解决方案都是集中式的且昂贵的。有了 IPFS，分散式应用程序有了一种存储和访问这些内容而不失去分散性的方法。

# Aragon

**Aragon**是一个围绕**分布式自治组织**或**DAO**的项目。以下是 Aragon 白皮书的摘录：

+   Aragon 是一个 DApp，允许任何人在以太坊区块链上创建和管理任何类型的组织（公司、开源项目、非政府组织、基金会、对冲基金等）。

+   Aragon 实现了组织的基本功能，如股权表、代币转移、投票、角色分配、筹款和会计。通过更改章程，Aragon 组织的行为可以轻松定制。此外，Aragon 组织可以通过与组织合约交互的第三方模块进行扩展。

+   Aragon Core 是用 Solidity 编写的一组智能合约，允许分布式团队自组织，并轻松处理典型集中式组织的活动，例如处理工资单、内部仲裁等。

+   Aragon Core 中的智能合约已被其他项目使用，例如 districtOx，作为更高级功能的基础。如果你的项目涉及任何形式的分布式治理，那么研究一下 Aragon Core 是有意义的。

# district0x

districtOx 网络建立在以太坊、Aragon 和 IPFS 之上。它利用了所有这些系统的能力，并为更具体的功能进行了扩展。在这种情况下，districtOx 提供了在以太坊区块链和分布式治理下以去中心化方式操作在线市场或社区所必需的核心功能。

# 什么是地区？

地区是建立在 districtOx `d0xINFRA`代码库之上的去中心化市场/社区。`d0xINFRA`代码库由一组以太坊智能合约和基于浏览器的工具组成，可以与以太坊和 IPFS 互动。这两个代码库相互交互，并呈现一组对于人们在中心化网络上习惯的体验至关重要的关键功能：发布和列出内容、搜索、声誉管理、支付和发票。

在`d0xINFRA`基础上构建的每个地区都将具有这些基本功能。这一基线代码库使得未来项目更容易更快地发展成为功能齐全的产品。

# 以太坊命名服务

以太坊地址通常被写成十六进制字符串，例如，`0x86fa049857e0209aa7d9e616f7eb3b3b78ecfdb0`。这对于人类来说不太可读，如果你不得不在电话中读出来，打字等等，很容易出错。替换成另一个地址也很容易，而不让别人知道。事实上，这在几次 ICO 攻击中已经发生过。以太坊命名服务，或 ENS，是一个基于智能合约的系统，用于解析人类可读名称，例如`mytoken.ens`到地址。通过注册 ENS 地址，以太坊网络上兼容的应用程序和钱包可以将可读名称，例如`MyTokenContract.eth`，映射到一个以太坊地址，类似于 DNS 将域名映射到互联网上的 IP 地址。

强烈建议通过 Ethereum 获得适当的 ENS 名称来保护任何建立在以太坊上的项目。这不仅对用户更加清晰，而且有助于防止黑客利用名称试图从您的用户那里窃取。

# Civic/uPort

Civic 和 uPort 都是以太坊上的身份提供者 DApp。目前，您的身份信息通常由一个集中实体持有：政府、Facebook、Google 等等。在网络上的许多地方，您可能会被要求使用 Facebook 或 Google 进行登录。实际上，网站会联系其中一个提供者，交出身份认证，然后您就被允许登录。这样做的缺点是，您所放弃的信息受到第三方的控制和管理。如果这些提供者之一决定不再为您提供服务，或者提供虚假信息，您几乎无能为力。

Civic 和 uPort 都是身份的去中心化解决方案，在这里，身份所有者在区块链上管理他们的身份，并通过一个他们控制的服务提供者授予和撤销权限。

许多即将推出的 DApp 具有区块链行为、web 活动和移动应用程序行为的混合。通过使用这些提供商之一，您可以连接到新兴的去中心化身份生态系统，还能支持中心化提供者。

# Gnosis

**Gnosis**是以太坊上首个重要的去中心化应用。Gnosis 提供了一个去中心化的预测市场和治理工具。预测市场可以在各个行业发挥作用，比如股票市场、事件赌博等等。通过采用去中心化的预测方法，希望这样的预测更加准确，因为市场接收了更多信息来调整预测。

作为以太坊最早的采用者之一，Gnosis 团队还致力于各种工具，比如多重签名钱包。

# Steemit

**Steemit**是一个社交博客应用，类似于 Blogger 或 Tumblr。然而，内容、评论和投票都存储在区块链上并得到了保护。Steemit 是一个自带区块链的 DApp。其核心源自 Bitshares v2.0，但经过大幅修改以适应应用的需求。

在 Steemit 中，用户提交和投票内容也会得到奖励代币。每个用户的投票权力与他们在网络中的股份相等，被称为**Steem Power**。如果一个用户吸引了大量追随者，或者追随者拥有大量 Steem Power，那么奖励可能是可观的。奖励通常很小（从几分钱到几美元不等），但一些作者由于吸引了被称为**鲸鱼**的权力用户的青睐，已经能够获得数千美元的支付。在某些情况下，一个鲸鱼的投票本身就可能价值数百甚至上千美元。

如前所述，Steemit 不是建立在以太坊上，也不能使用 Solidity 进行编程。但是，它确实拥有一系列应用程序，这些应用程序与 Steemit 区块链进行通信，并以不同的方式对 Steemit 内容进行筛选、显示和货币化。任何考虑博客、社交媒体或类似内容应用的人都应该仔细评估 Steemit 及其代码库。所有代码都是开源的，已经创建了一些修改过的克隆版本，例如 Golos（用于俄罗斯市场）和 Serey（用于柬埔寨市场）。

# CryptoKitties

**CryptoKitties** 是另一个基于以太坊的去中心化应用程序。CryptoKitties 是一个虚拟宠物模拟器，用户可以在区块链上购买、交易和繁殖小猫。CryptoKitties 对以太坊来说是一个重要的里程碑，因为为 CryptoKitties 开发的技术对可能使用区块链的所有视频游戏都有应用。使用类似于 CryptoKitties 的技术，玩家的装备、角色等都可以存储在区块链上。

这很重要，因为许多在线视频游戏，例如 Minecraft、魔兽世界等，都存在一些漏洞，其中游戏中的某些装备可以被复制，人们可以制作无限的克隆品。使用区块链，每个物品都被分配了一个唯一的参考，并且可以像真实商品一样跟踪和交易。

受到 CryptoKitties 的启发，许多视频游戏正在使用这些系统来创造真正稀缺和真正经济的世界，即将进入市场。

# 摘要

您现在应该了解去中心化应用程序和分布式应用程序之间的区别。分布式应用程序是指分布在许多服务器和系统上的应用程序，理想情况下，涉及的计算机也分布在多个地理区域，用于备份、处理和可用性。DApp 是一种没有单个公司、个人或团体控制应用程序运行的应用程序。

尽管市场上有许多区块链应用程序，但并不是所有这些应用程序都是真正的去中心化。在许多情况下，这些应用程序仅仅是通过依附于公共区块链网络来实现不同的分布式方式。如果一个公司或少数关键用户仍然控制应用程序的操作和功能，那么即使它在一个去中心化网络上运行，该应用程序也不是真正的去中心化。

您现在应该了解到目前存在的许多最大的面向区块链的去中心化应用程序，它们之间的相互关系，并且您应该能够利用这些知识来为未来的项目提供信息，并避免重新发明现有的代码。

接下来，我们将详细讨论两个最大的区块链网络——比特币和以太坊——如何在第十八章中确保网络的安全，*挖矿*。

# 参考

[1] [`github.com/DavidJohnstonCEO/DecentralizedApplications`](https://github.com/DavidJohnstonCEO/DecentralizedApplications)
