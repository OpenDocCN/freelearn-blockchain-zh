# 理解去中心化应用

我们一直在使用的几乎所有基于互联网的应用都是集中式的，即每个应用的服务器都由特定公司或个人拥有。开发者一直在构建集中式应用，用户也一直在使用它们很长时间。但是集中式应用存在一些问题，使得几乎不可能构建某些类型的应用程序，并且每个应用程序最终都会有一些共同的问题。集中式应用的一些问题是较不透明，具有单一故障点，未能防止网络审查等等。由于这些问题，出现了一种新技术用于构建基于互联网的应用程序，称为**去中心化应用**（**DApps**）。在本章中，我们将了解去中心化应用。

在本章中，我们将涵盖以下主题：

+   什么是 DApp？

+   去中心化、集中化和分布式应用之间有什么区别？

+   集中式和去中心化应用的优缺点。

+   一些最流行的 DApp 使用的数据结构、算法和协议概述

+   了解一些建立在其他 DApps 之上的热门 DApps。

# 什么是 DApp？

DApp 是一种后端运行在去中心化对等网络上的互联网应用，其源代码是开源的。网络中的没有一个单一节点对 DApp 拥有完全控制权。

根据 DApp 的功能不同，使用不同的数据结构来存储应用数据。例如，比特币 DApp 使用区块链数据结构。

这些对等体可以是任何连接到互联网的计算机；因此，检测和防止对等体对应用数据进行无效更改并与他人共享错误信息变成一项重大挑战。因此，我们需要对等体之间就发布的数据是正确还是错误达成共识。在 DApp 中没有中央服务器来协调对等体并决定什么是对什么是错；因此，解决这个挑战变得非常困难。有一些协议（专门称为共识协议）来解决这个挑战。共识协议是专门为 DApp 使用的数据结构设计的。例如，比特币使用工作量证明协议来达成共识。

每个 DApp 都需要一个客户端供用户使用。为了使用 DApp，我们首先需要通过运行自己的节点服务器来连接客户端到节点服务器。DApp 的节点仅提供一个 API 并让开发者社区使用 API 开发各种客户端。一些 DApp 开发者正式提供客户端。DApps 的客户端应该是开源的，应该可以下载使用；否则，去中心化的整个概念将失败。

但是，客户端体系结构设置是繁琐的，特别是对于非开发人员的用户；因此，客户端通常是托管的，和/或节点作为服务托管，以使使用 DApp 的过程更加简单。

**什么是分布式应用程序？**

分布式应用程序是那些分布在多个服务器上而不仅仅是一个的应用程序。当应用程序数据和流量变得巨大且应用程序的停机时间是不可承受的时，就必须采用分布式应用程序。在分布式应用程序中，数据在各个服务器之间复制，以实现数据的高可用性。中心化应用程序可能是分布式的，也可能不是，但去中心化应用程序总是分布式的。例如，谷歌、Facebook、Slack、Dropbox 等都是分布式的，而简单的投资组合网站或个人博客通常在流量非常高时才会被分布。

# 去中心化应用程序的优势

以下是去中心化应用程序的一些优势：

+   DApps 具有容错性，因为它们默认情况下是分布式的，没有单点故障。

+   它们可以防止网络审查的侵犯，因为没有中央机构可以被政府施压去除一些内容。政府甚至无法屏蔽应用程序的域名或 IP 地址，因为 DApps 不是通过特定的 IP 地址或域名访问的。显然，政府可以通过 IP 地址追踪网络中的个别节点并关闭它们，但如果网络很庞大，那么关闭应用程序将变得几乎不可能，特别是如果节点分布在不同国家。

+   用户很容易信任该应用程序，因为它不受可能出于利润目的欺骗用户的单一权威机构的控制。

# 去中心化应用程序的缺点

显然，每个系统都有一些优点和缺点。以下是去中心化应用程序的一些缺点：

+   修复错误或更新 DApps 非常困难，因为网络中的每个对等体都必须更新其节点软件。

+   有些应用程序需要验证用户身份（即 KYC），由于没有中央机构来验证用户身份，因此在开发此类应用程序时会成为一个问题。

+   它们难以构建，因为它们使用非常复杂的协议来实现共识，并且必须从一开始就构建以适应规模。因此，我们不能只是实现一个想法，然后稍后添加更多功能并扩展它。

+   应用程序通常独立于第三方 API 来获取或存储内容。DApps 不应依赖于中心化的应用程序 API，但 DApps 可能依赖于其他 DApps。由于目前还没有一个庞大的 DApps 生态系统，因此构建 DApp 非常困难。尽管理论上 DApps 可能依赖于其他 DApps，但在实际上紧密耦合 DApps 却非常困难。

# 去中心化自治组织

通常，签署的文件代表组织，并且政府对其有影响力。根据组织的类型，该组织可能有或没有股东。

**分散自治组织**（**DAO**）是由计算机程序代表的组织（也就是说，组织按照程序中编写的规则运行），完全透明，由股东完全控制，且不受政府影响。

要实现这些目标，我们需要开发一个 DAO 作为 DApp。因此，我们可以说 DAO 是 DApp 的子类。

Dash 和 DAC 是 DAO 的几个示例。

**什么是分散自治公司（DAC）？** 目前仍然没有明确区分 DAC 和 DAO 的差异。许多人认为它们是相同的，而有些人将 DAC 定义为 DAO，当 DAO 旨在为股东赚取利润时。

# DApps 中的用户身份

DApps 的一个主要优点是它通常保证用户匿名性。但许多应用程序需要验证用户身份才能使用该应用程序。由于 DApp 中没有中央权威，验证用户身份成为一项挑战。

在集中式应用程序中，人们通过请求用户提交某些扫描文档、OTP 验证等方式来验证用户身份。这个过程称为**了解您的客户**（**KYC**）。但是在 DApps 中没有人来验证用户身份，DApp 必须自行验证用户身份。显然，DApps 无法理解和验证扫描文档，也无法发送短信；因此，我们需要为它们提供可以理解和验证的数字身份。主要问题在于几乎没有 DApps 有数字身份，只有少数人知道如何获得数字身份。

数字身份有各种形式。目前，最推荐和流行的形式是数字证书。数字证书（也称为公钥证书或身份证书）是用于证明公钥所有权的电子文档。基本上，用户拥有私钥、公钥和数字证书。私钥是秘密的，用户不应该与任何人分享。公钥可以与任何人分享。数字证书包含公钥和关于谁拥有该公钥的信息。显然，生成此类证书并不困难；因此，数字证书始终由您可以信任的授权实体颁发。数字证书具有一个由证书颁发机构的私钥加密的字段。要验证证书的真实性，我们只需使用证书颁发机构的公钥解密该字段，如果解密成功，则我们知道该证书是有效的。

即使用户成功获取了数字身份并且它们由 DApp 验证，仍然存在一个主要问题；那就是，存在各种数字证书颁发机构，要验证数字证书，我们需要颁发机构的公钥。要包括所有颁发机构的公钥并更新/添加新的公钥是非常困难的。由于这个问题，数字身份验证程序通常包含在客户端，以便可以轻松更新。将此验证程序移到客户端并不能完全解决这个问题，因为有很多机构颁发数字证书，并跟踪所有机构，并将它们添加到客户端是繁琐的。

**为什么用户不互相验证身份？**

在现实生活中进行交易时，我们通常会自行验证对方的身份，或者请权威机构来验证身份。这个想法也可以应用于 DApps。用户可以在彼此进行交易之前手动验证对方的身份。这个想法适用于特定类型的 DApps，即那些人们在其中互相交易的 DApps。例如，如果一个 DApp 是一个去中心化的社交网络，那么显然无法通过这种方式验证个人资料。但如果 DApp 是用于人们买卖东西的，那么在付款之前，买家和卖家都可以验证对方的身份。虽然在交易时这个想法看起来不错，但实际上思考一下就会发现，这变得非常困难，因为你可能不想每次交易都进行身份验证，而且不是每个人都知道如何进行身份验证。例如，如果一个 DApp 是一个打车应用程序，那么显然你不会希望每次预订车辆之前都进行身份验证。但如果你偶尔进行交易并且知道如何验证身份，那么遵循这个流程是可以的。

由于这些问题，我们当前唯一的选择是由提供客户端的公司的授权人员手动验证用户身份。例如，创建比特币帐户时不需要身份证明，但是在将比特币提取到法定货币时，交易所会要求身份证明。客户端可以忽略未经验证的用户，并不让他们使用客户端。他们可以为已由他们验证身份的用户保持客户端开放。这种解决方案也会出现一些小问题；也就是说，如果您更换客户端，您将无法找到相同的一组用户进行交互，因为不同的客户端具有不同的已验证用户集。由于这个原因，所有用户可能决定只使用一个特定的客户端，从而在客户端之间产生垄断。但这并不是一个主要问题，因为如果客户端未能正确验证用户，那么用户可以轻松地切换到另一个客户端，而不会丢失关键数据，因为它们被存储为去中心化。

在应用程序中验证用户身份的想法是为了让用户在执行某种欺诈活动后难以逃脱，防止具有欺诈/犯罪背景的用户使用应用程序，并为网络中的其他用户提供相信用户是其声称的身份的手段。无论使用什么程序来验证用户身份，用户都有办法将自己代表成其他人。无论我们使用数字身份还是扫描文档进行验证都无关紧要，因为两者都可以被盗用和重复使用。重要的是要让用户难以将自己代表成其他人，并收集足够的数据来追踪用户并证明用户进行了欺诈活动。

# DApps 中的用户账户

许多应用程序需要用户账户的功能。与账户相关的数据应仅由账户所有者修改。DApps 不能像中心化应用程序一样拥有基于用户名和密码的账户功能，因为密码无法证明账户数据变更是由所有者请求的。

有很多种方法可以在 DApp 中实现用户账户。但最流行的方法是使用公私钥对来表示账户。公钥的哈希是账户的唯一标识符。要更改账户数据，用户需要使用他/她的私钥签署更改。我们需要假设用户会安全地存储他们的私钥。如果用户丢失了他们的私钥，那么他们将永远无法访问自己的账户。

# 访问中心化应用程序

由于单点故障，DApp 不应依赖于中心化应用程序。但在某些情况下，别无选择。例如，如果一个 DApp 想要读取足球比分，那么它将从哪里获取数据？尽管一个 DApp 可以依赖于另一个 DApp，但 FIFA 为什么会创建一个 DApp 呢？FIFA 不会仅因为其他 DApps 需要数据而创建一个 DApp。这是因为提供比分的 DApp 毫无益处，因为它最终将完全由 FIFA 控制。

在某些情况下，DApp 需要从中心化应用程序获取数据。但主要问题是 DApp 如何知道从域中获取的数据没有被中间服务/人篡改，而是实际的响应。嗯，根据 DApp 的架构，有各种解决方法。例如，在以太坊中，为了让智能合约访问中心化的 API，它们可以使用 Oraclize 服务作为中间人，因为智能合约不能直接进行 HTTP 请求。Oraclize 为智能合约从中心化服务获取的数据提供了 TLSNotary 证明。

# DApps 中的内部货币

对于一个中心化的应用程序来说，要长期维持下去，应用程序的所有者需要盈利才能保持其运行。DApps 没有所有者，但是像任何其他中心化应用程序一样，DApp 的节点需要硬件和网络资源来保持其运行。因此，DApp 的节点需要得到一些有用的回报来维持 DApp 的运行。这就是内部货币发挥作用的地方。大多数 DApps 都有内置的内部货币，或者我们可以说大多数成功的 DApps 都有内置的内部货币。

共识协议决定节点获得多少货币。根据共识协议，只有某些类型的节点才能获得货币。我们还可以说，贡献于保持 DApp 安全运行的节点是获得货币的节点。只读取数据的节点不会得到任何奖励。例如，在比特币中，只有矿工成功挖掘区块才能获得比特币。

最大的问题是，由于这是一种数字货币，为什么有人会看重它？嗯，根据经济学的观点，任何有需求但供应不足的东西都会有价值。

通过使用内部货币让用户付费使用 DApp 可以解决需求问题。随着越来越多的用户使用 DApp，需求也会增加，因此内部货币的价值也会相应增加。

设定一个固定数量的可生产货币使货币变得稀缺，从而提高其价值。

货币是随着时间的推移供应而不是一次性供应的。这样做是为了让进入网络的新节点也能够保持网络的安全运行并获得货币。

# DApps 中内部货币的缺点

在 DApps 中拥有内部货币的唯一缺点是，DApps 不再免费使用。这是中心化应用程序获得优势的地方之一，因为中心化应用程序可以通过广告获利，为第三方应用提供高级 API 等，可以免费为用户提供服务。

在 DApps 中，我们无法集成广告，因为没有人来检查广告标准；客户端可能不显示广告，因为对他们来说显示广告没有任何好处。

# 什么是有权限的 DApps？

直到现在，我们一直在了解完全开放和无需许可的 DApps；也就是说，任何人都可以参与，无需建立身份。

另一方面，有权限的 DApps 并不对所有人开放参与。有权限的 DApps 继承了所有无权限 DApps 的属性，除了你需要获得参与网络的许可。有权限的 DApps 之间的许可制度各不相同。

要加入一个有权限的 DApp，你需要获得许可，因此无权限 DApps 的共识协议可能在有权限的 DApps 中不太有效；因此，它们具有不同于无权限 DApps 的共识协议。有权限的 DApps 没有内部货币。

# 热门 DApps

现在我们对 DApp 是什么以及它们与中心化应用的不同有一些高层次的了解，让我们探索一些流行且有用的 DApp。在探索这些 DApp 时，我们将对它们进行足够深入的探索，以了解它们的工作原理并解决各种问题，而不是深入挖掘。

# 比特币

比特币是一种分散的货币。比特币是最流行的 DApp，它的成功展示了 DApp 可有多强大，并鼓励人们建立其他 DApp。

在我们深入了解比特币的工作原理和为什么人们和政府认为它是一种货币之前，我们需要了解什么是分类帐和区块链。

# 什么是分类帐？

分类帐基本上是交易的列表。数据库与分类帐不同。在分类帐中，我们只能追加新的交易，而在数据库中，我们可以追加、修改和删除交易。数据库可以用于实现分类帐。

# 什么是区块链？

区块链是用于创建分散分类帐的数据结构。区块链以串行方式由块组成。一个块包含一组交易、前一个块的哈希、时间戳（表示块的创建时间）、块奖励、块编号等。每个块都包含前一个块的哈希，从而创建了相互链接的块链。网络中的每个节点都保存着区块链的副本。

工作量证明、股权证明等是用于保持区块链安全的各种共识协议。根据共识协议的不同，区块以不同的方式创建并添加到区块链中。在工作量证明中，区块是通过称为挖掘的过程创建的，这可以保持区块链的安全。在工作量证明协议中，挖掘涉及解决复杂的难题。我们将在本书后面详细了解更多关于区块链及其共识协议的知识。

比特币网络中的区块链保存着比特币交易。新的比特币通过向成功挖掘区块的节点发放新的比特币来供应到网络中。

区块链数据结构的主要优势在于自动化审计，并使应用程序透明而安全。它可以防止欺诈和腐败。根据您实现和使用的方式，它可以用于解决许多其他问题。

# 比特币是否合法？

首先，比特币不是一种国际货币；相反，它是一种分散的货币。国际货币大多是合法的，因为它们是一种资产，而且它们的使用是显而易见的。

主要问题是只使用货币的 DApp 是否合法。直截了当的答案是，在许多国家都是合法的。只有极少数国家已经将其定为非法，而大多数国家尚未决定。

这是一些国家已将之定为非法而大多数尚未决定的原因：

+   由于在 DApp 中存在身份问题，在比特币中用户帐户没有任何与之相关的身份，因此它可以用于洗钱。

+   这些虚拟货币非常波动，因此人们失去金钱的风险更大

+   在使用虚拟货币时，逃税真的很容易

# 为什么有人会使用比特币？

比特币网络仅用于发送/接收比特币，什么都不是。所以你一定会想为什么会有人对比特币有需求。

以下是一些人们使用比特币的原因：

+   使用比特币的主要优势在于，使得在世界任何地方发送和接收支付变得简单和快捷。

+   在线支付交易费用与比特币交易费用相比昂贵

+   黑客可以从商家那里窃取你的支付信息，但是在比特币的情况下，窃取比特币地址是完全无用的，因为为了交易有效，必须使用其关联的私钥进行签名，用户不需要与任何人分享私钥来进行付款。

# 以太坊

以太坊是一个分散的平台，允许我们在其上运行 DApps。这些 DApps 是使用智能合约编写的。一个或多个智能合约可以一起形成一个 DApp。以太坊智能合约是在以太坊上运行的程序。智能合约会按照编程时的准确程序运行，没有任何的停机、审查、欺诈和第三方的干涉的可能性。

使用以太坊运行智能合约的主要优势在于，它让智能合约之间的互动变得更加容易。此外，你不需要担心集成共识协议和其他事务；相反，你只需要编写应用程序逻辑。明显地，你无法使用以太坊构建任何类型的 DApp；你只能构建那些被以太坊支持的特性的 DApp。

以太坊有一种内部货币叫做以太。要部署智能合约或执行智能合约的功能，你需要以太。

本书致力于利用以太坊构建 DApps。在本书中，你将深入学习以太坊的每一个方面。

# Hyperledger 项目

Hyperledger 是一个致力于构建用于构建许可 DApps 技术的项目。Hyperledger fabric（简称 fabric）是 Hyperledger 项目的一个实现。其他的实现包括 Intel Sawtooth 和 R3 Corda。

Fabric 是一个许可的分散平台，允许我们在其上运行许可的 DApps（称为链码）。我们需要部署我们自己的 Fabric 实例，然后在其上部署我们的许可 DApps。网络中的每个节点都运行 Fabric 的一个实例。Fabric 是一个即插即用的系统，你可以很容易的插拔各种共识协议和功能。

Hyperledger 使用了区块链数据结构。基于 Hyperledger 的区块链目前可以选择不采用共识协议（即**NoOps** 协议），或者使用**PBFT**（**Practical Byzantine Fault Tolerance**）共识协议。它有一个特殊的节点叫做证书颁发机构，它控制着谁可以加入网络以及他们可以做什么。

# IPFS

**IPFS**（**星际文件系统**）是一个分散式文件系统。IPFS 使用 **DHT**（**分布式哈希表**）和 Merkle **DAG**（**有向无环图**）数据结构。它使用类似于 BitTorrent 的协议来决定如何在网络中移动数据。IPFS 的一个高级功能是它支持文件版本控制。为了实现文件版本控制，它使用类似于 Git 的数据结构。

尽管它被称为分散式文件系统，但它并不遵循文件系统的一个主要属性；也就是说，当我们在文件系统中存储某些东西时，它保证会一直存在直到被删除。但 IPFS 并非如此运作。每个节点并不保存所有文件；它存储它所需要的文件。因此，如果一个文件不太受欢迎，那么显然许多节点都不会拥有它；因此，文件从网络中消失的可能性很大。因此，许多人更喜欢将 IPFS 称为分散式对等文件共享应用程序。或者，您可以将 IPFS 视为完全分散式的 BitTorrent；也就是说，它没有跟踪器并具有一些高级功能。

# 它是如何工作的？

让我们看一下 IPFS 的工作概述。当我们将文件存储在 IPFS 中时，它会被分成小于 256 KB 的块，并为每个块生成哈希值。网络中的节点在哈希表中保存它们需要的 IPFS 文件及其哈希值。

IPFS 文件有四种类型：blob、list、tree 和 commit。blob 表示存储在 IPFS 中的实际文件块。list 表示完整文件，因为它保存了 blob 和其他 list 的列表。由于列表可以包含其他列表，它有助于通过网络进行数据压缩。tree 表示目录，因为它保存了 blob、list、其他 tree 和 commit 的列表。而 commit 文件表示任何其他文件版本历史中的快照。由于列表、tree 和 commit 具有指向其他 IPFS 文件的链接，它们形成了 Merkle DAG。

因此，当我们想要从网络下载文件时，我们只需要 IPFS 列表文件的哈希。或者，如果我们想要下载一个目录，那么我们只需要 IPFS 树文件的哈希。

由于每个文件都由哈希值标识，因此名称不容易记住。如果我们更新了一个文件，那么我们需要与想要下载该文件的所有人共享一个新的哈希值。为了解决这个问题，IPFS 使用了 IPNS 功能，它允许使用自我认证的名称或人性化名称指向 IPFS 文件。

# Filecoin

阻止 IPFS 成为分散式文件系统的主要原因是节点仅存储它们需要的文件。Filecoin 是一个类似于 IPFS 的分散式文件系统，具有内部货币以激励节点存储文件，从而提高文件可用性，使其更像一个文件系统。

网络中的节点将赚取 Filecoins 来租用磁盘空间，而要存储/检索文件，您需要花费 Filecoins。

除了 IPFS 技术之外，Filecoin 使用了区块链数据结构和可检索性证明共识协议。

在撰写本文时，Filecoin 仍在开发中，因此许多事情仍不清楚。

# Namecoin

Namecoin 是一个去中心化的键值数据库。它也有一种内部货币，叫做 Namecoins。Namecoin 使用区块链数据结构和工作量证明共识协议。

在 Namecoin 中，您可以存储键值对数据。要注册键值对，您需要花费 Namecoins。一旦注册，您需要在每 35,999 个区块中更新一次；否则，与键关联的值将过期。要更新，您也需要 Namecoins。无需更新密钥；也就是说，注册密钥后，您无需花费任何 Namecoins 来保留密钥。

Namecoin 拥有命名空间功能，允许用户组织不同类型的密钥。任何人都可以创建命名空间或使用现有的命名空间来组织密钥。

一些最受欢迎的命名空间包括 `a`（应用程序特定数据）、`d`（域名规范）、`ds`（安全域名）、`id`（身份）、`is`（安全身份）、`p`（产品）等等。

# .bit 域

要访问一个网站，浏览器首先需要找到与域关联的 IP 地址。这些域名和 IP 地址的映射存储在 DNS 服务器中，由大型公司和政府控制。因此，域名容易受到审查。如果网站做出非法行为、给他们造成损失或出于其他原因，政府和公司通常会阻止域名。

因此，有必要建立一个去中心化的域名数据库。由于 Namecoin 像 DNS 服务器一样存储键值数据，因此可以使用 Namecoin 来实现去中心化 DNS，这已经得到了应用。d 和 ds 命名空间包含以 `.bit` 结尾的键，表示 `.bit` 域名。从技术上讲，命名空间对键没有任何命名约定，但是所有的 Namecoin 节点和客户端都同意这个命名约定。如果我们尝试在 `d` 和 `ds` 命名空间中存储无效的键，那么客户端将过滤掉无效的键。

支持 `.bit` 域的浏览器需要在 Namecoin 的 `d` 和 `ds` 命名空间中查找与 `.bit` 域关联的 IP 地址。

`d` 和 `ds` 命名空间的区别在于 `ds` 存储支持 TLS 的域，而 `d` 存储不支持 TLS 的域。我们已经使 DNS 实现了去中心化；同样，我们也可以使 TLS 证书的签发去中心化。

这就是在 Namecoin 中 TLS 的工作原理。用户创建自签名证书并将证书哈希存储在 Namecoin 中。当支持 `.bit` 域的客户端尝试访问安全的 `.bit` 域时，它将与服务器返回的证书哈希进行匹配，并且如果匹配，则继续与服务器进行进一步的通信。

使用 Namecoin 形成的分散的 DNS 是 Zooko 三角的第一个解决方案。Zooko 三角定义了拥有三种属性的应用程序，即分散式、身份和安全。数字身份不仅用于代表一个人，还可以代表域名、公司或其他东西。

# Dash

Dash 是一种类似比特币的分散式货币。Dash 使用区块链数据结构和工作量证明共识协议。Dash 解决了比特币导致的一些主要问题。以下是与比特币相关的一些问题：

+   交易需要几分钟才能完成，在今天的世界中，我们需要交易立即完成。这是因为比特币网络中的挖矿难度被调整得平均每 10 分钟创建一个区块。我们将在本书后面更多地了解挖矿。

+   虽然账户没有与其关联的身份，但在交易所将比特币交易为真实货币或用比特币购买东西是可追踪的；因此，这些交易所或商家可以向政府或其他机构透露你的身份。如果你运行自己的节点来发送/接收交易，那么你的 ISP 可以看到比特币地址，并使用 IP 地址追溯所有者，因为比特币网络中的广播消息没有加密。

Dash 旨在通过使交易几乎即时结算并使真实账户的背后的真实人不再被识别来解决这些问题。它还防止你的 ISP 跟踪你。

在比特币网络中，有两种节点，即矿工和普通节点。但在 Dash 中，有三种节点，即矿工，主节点和普通节点。主节点是使 Dash 如此特别的原因。

# 分散式治理和预算

要托管一个主节点，你需要拥有 1,000 个 Dash 和一个静态 IP 地址。在 Dash 网络中，主节点和矿工都赚取 Dash。当一个区块被挖出时，45%的奖励给矿工，45%给主节点，剩下的 10%用于预算系统。

主节点实现了分散式治理和预算。由于分散式治理和预算系统，Dash 被称为 DAO，因为它确实是这样的。

网络中的主节点就像股东一样；他们有权决定 10%的 Dash 去向。这 10%的 Dash 通常用于资助其他项目。每个主节点有权利使用一票来批准一个项目。

项目提案的讨论发生在网络之外。但投票在网络中进行。

主节点可以为 DApps 中的用户身份验证提供可能的解决方案；也就是说，主节点可以民主地选择一个节点来验证用户身份。这个节点背后的人或企业可以手动验证用户文件。部分奖励也可以给这个节点。如果节点不能提供良好的服务，那么主节点可以投票选举另一个节点。这可以是去中心化身份问题的一个良好解决方案。

# 去中心化服务

主节点不仅仅是批准或拒绝提案，还构成了提供各种服务的服务层。主节点提供服务的原因是，它们提供的服务越多，网络就变得越功能丰富，从而增加了用户和交易量，这就增加了 Dash 货币的价格和区块奖励，从而帮助主节点赚取更多利润。

主节点提供诸如 PrivateSend（提供匿名的币混合服务）、InstantSend（提供几乎即时的交易服务）、DAPI（提供去中心化 API，以便用户不需要运行节点）等服务。

在任何给定时间，只有 10 个主节点被选中。选择算法使用当前区块哈希来选择主节点。然后，我们从他们那里请求服务。从大多数节点接收到的响应被认为是正确的。这就是如何实现对主节点提供的服务达成共识的方式。

服务证明共识协议用于确保主节点在线、响应正常，并且其区块链是最新的。

# BigChainDB

BigChainDB 允许您部署自己的权限或无权限的去中心化数据库。它使用区块链数据结构以及各种其他特定于数据库的数据结构。在撰写本文时，BigChainDB 仍在开发中，因此许多事情尚不清楚。

它还提供许多其他功能，如丰富的权限、查询、线性扩展和对多资产以及联盟共识协议的本地支持。

# OpenBazaar

OpenBazaar 是一个去中心化的电子商务平台。您可以使用 OpenBazaar 购买或出售商品。在 OpenBazaar 网络中，用户并不匿名，因为他们的 IP 地址被记录下来。一个节点可以是买家、卖家或调解员。

它使用 Kademlia 风格的分布式哈希表数据结构。卖家必须托管一个节点并保持其运行，以使商品在网络中可见。

它通过使用工作量证明共识协议来防止账户垃圾邮件。它使用 proof-of-burn、CHECKLOCKTIMEVERIFY 和安全存款共识协议来防止评分和评论垃圾邮件。

买家和卖家使用比特币进行交易。买家在购买商品时可以添加一个调解员。调解员负责解决买家和卖家之间发生的任何纠纷。任何人都可以成为网络中的调解员。调解员通过解决纠纷来赚取佣金。

# Ripple

Ripple 是一个去中心化的汇款平台。它允许我们转移法定货币、数字货币和大宗商品。它使用区块链数据结构，并拥有自己的共识协议。在 Ripple 的文档中，你不会找到 blocks 和 blockchain 这个术语；他们使用 ledger 这个术语。

在 Ripple 中，货币和商品的转移通过信任链方式进行，类似于哈瓦拉网络的运作方式。在 Ripple 中，有两种类型的节点，即网关和常规节点。网关支持一个或多个货币和/或商品的存款和提款。要成为 Ripple 网络中的网关，您需要作为网关获得许可以形成信任链。网关通常是注册的金融机构、交易所、商家等。

每个用户和网关都有一个帐户地址。每个用户都需要将他们信任的网关的地址添加到信任列表中。没有共识找到信任谁；这完全取决于用户，并且用户承担信任网关的风险。甚至网关也可以添加他们信任的网关列表。

让我们来看一个示例，用户 X 住在印度，想向住在美国的用户 Y 发送 500 美元。假设印度有一个名为 XX 的网关，它接受现金（实体现金或网站上的卡支付）并仅在 Ripple 上给你印度卢比余额，X 将访问 XX 的办事处或网站，存入 30,000 印度卢比，然后 XX 将广播一笔交易，表示我欠 X 30,000 印度卢比。现在假设美国有一个名为 YY 的网关，它仅允许美元交易，并且 Y 信任 YY 网关。现在，假设网关 XX 和 YY 互不信任。由于 X 和 Y 不信任一个共同的网关，XX 和 YY 互不信任，最终 XX 和 YY 不支持相同的货币。因此，要让 X 向 Y 发送资金，他需要找到中间网关以形成信任链。假设还有另一个网关 ZZ，它被 XX 和 YY 信任，并支持美元和印度卢比。因此，现在 X 可以通过将 50,000 印度卢比从 XX 转移到 ZZ 发送交易，并由 ZZ 转换为美元，然后 ZZ 将资金发送给 YY，要求 YY 将资金交给 Y。现在，与其说 X 欠 Y 500 美元，不如说 YY 欠 Y 500 美元，ZZ 欠 YY 500 美元，XX 欠 ZZ 30,000 印度卢比。但这都没关系，因为他们彼此信任，而之前 X 和 Y 不信任对方。但是 XX、YY 和 ZZ 可以随时在 Ripple 外转移资金，否则逆向交易会扣除这个价值。

Ripple 还有一种名为 XRP（或水波）的内部货币。发送到网络的每笔交易都会消耗一些水波。由于 XRP 是水波的本地货币，因此可以向网络中的任何人发送，而无需信任。XRP 也可以在形成信任链时使用。请记住，每个网关都有自己的货币兑换率。XRP 不是通过挖矿过程生成的；相反，在开始时生成了总共 1000 亿个 XRP，并由水波公司自己拥有。根据各种因素手动提供 XRP。

所有交易都记录在去中心化账本中，形成不可变的历史。需要共识确保所有节点在某一时间点具有相同的账本。在 Ripple 中，还有一种称为验证者的第三种节点，它们是共识协议的一部分。验证者负责验证交易。任何人都可以成为验证者。但其他节点会保留可以实际信任的验证者列表。这个列表被称为 UNL（唯一节点列表）。验证者也有一个 UNL；即，它信任的验证者也希望达成共识。目前，Ripple 决定了可以信任的验证者列表，但如果网络认为 Ripple 选择的验证者不值得信任，那么他们可以在其节点软件中修改列表。

你可以通过获取前一个账本并应用自那时起发生的所有交易来形成一个账本。因此，要就当前账本达成一致，节点必须就前一个账本和自那时起发生的交易集达成一致。创建新账本后，节点（包括普通节点和验证者）启动计时器（几秒钟，大约 5 秒钟），并收集在上一个账本创建期间到达的新交易。当计时器到期时，它会选择至少 80%的 UNL 认为有效的那些交易，并形成下一个账本。验证者向网络广播一个提案（一组他们认为有效的交易，以形成下一个账本）。验证者可以多次广播对同一个账本的提案，如果他们决定根据来自其 UNL 和其他因素的提案更改有效交易的列表。因此，您只需要等待 5-10 秒，即可确保您的交易已被网络确认。

有些人想知道这是否会导致账本出现许多不同版本，因为每个节点可能有不同的 UNL。只要 UNL 之间存在最小程度的互联性，就会迅速达成共识。这主要是因为每个诚实的节点的主要目标是达成共识。

# 摘要

在本章中，我们学习了什么是 DApps，并简要了解了它们的工作原理。我们看到了一些 DApps 面临的挑战，以及这些问题的各种解决方案。最后，我们了解了一些流行的 DApps，并对它们的特点和工作原理有了一个概览。现在，你应该能够清楚地解释什么是 DApp，以及它是如何工作的。
